"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[984],{5984:(e,a,t)=>{t.d(a,{A:()=>p});var r=t(5155),s=t(2115),l=t(7982),n=t(7058),d=t(3693),i=t(8897),o=t.n(i),c=t(3665),u=t(3470),m=t(2577);t(7423);var b=t(1856),f=t(1340);t(6772);let p=e=>{let{wardId:a}=e,{user:t}=(0,f.A)(),[i,p]=(0,s.useState)(!0),[x,g]=(0,s.useState)(a||""),[h,v]=(0,s.useState)(new Date),[w,y]=(0,s.useState)((0,u.Se)()),[N,j]=(0,s.useState)((0,c.Lg)()),[C,D]=(0,s.useState)(!1),[I,O]=(0,s.useState)([]),[B,k]=(0,s.useState)(null),[A,M]=(0,s.useState)(!1),[S,P]=(0,s.useState)(null),[W,R]=(0,s.useState)(null),[E,G]=(0,s.useState)({patientCensus:"0",overallData:"0",nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",availableBeds:"0",unavailable:"0",plannedDischarge:"0",comment:"",total:"0"}),_=(0,s.useCallback)(()=>!!x&&("0"!==E.nurseManager||"0"!==E.RN||"0"!==E.PN||"0"!==E.WC||"0"!==E.newAdmit||"0"!==E.transferIn||"0"!==E.referIn||"0"!==E.transferOut||"0"!==E.referOut||"0"!==E.discharge||"0"!==E.dead||"0"!==E.availableBeds||"0"!==E.unavailable||"0"!==E.plannedDischarge||""!==E.comment.trim()),[E,x]);(0,s.useEffect)(()=>{M(_())},[E,_]),(0,s.useEffect)(()=>{let e=setTimeout(()=>{p(!1)},1e3);return()=>clearTimeout(e)},[]),(0,s.useEffect)(()=>{x&&V()},[x]),(0,s.useEffect)(()=>{{let e=new Date;v(e),y((0,u.Se)()),j((0,c.mI)(e)),T()}},[]),(0,s.useEffect)(()=>{let e=e=>{if(A)return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[A]),(0,s.useEffect)(()=>{let e=$();G(a=>({...a,total:e.toString(),overallData:e.toString()}))},[E.patientCensus,E.newAdmit,E.transferIn,E.referIn,E.transferOut,E.referOut,E.discharge,E.dead]);let T=async()=>{try{let e=(0,n.rJ)(l.db,"wardDailyRecords"),a=new Date().getFullYear(),t=new Date(a,0,1),r=new Date(a,11,31),s=(0,n.P)(e,(0,n._M)("date",">=",(0,c.Ol)(t)),(0,n._M)("date","<=",(0,c.Ol)(r))),d=await (0,n.GG)(s),i=new Map;d.docs.forEach(e=>{let a=e.data();if(!a.date)return;let t=a.date,r=a.shifts||{};i.has(t)||i.set(t,{shifts:new Set,wards:new Set}),Object.keys(r).forEach(e=>{i.get(t).shifts.add(e)}),i.get(t).wards.add(a.wardId)});let o=Array.from(i.entries()).map(e=>{let[a,t]=e;return{date:a,isComplete:t.shifts.size>=2,shifts:Array.from(t.shifts),wards:Array.from(t.wards),hasData:!0}});O(o),console.log("Dates with data:",o)}catch(e){console.error("Error fetching dates with data:",e),O([])}},L=async(e,a)=>{if(a)try{p(!0);let t=(0,n.rJ)(l.db,"wardDailyRecords"),r=new Date(e),s="";"19:00-07:00"===w?s="07:00-19:00":(r.setDate(r.getDate()-1),s="19:00-07:00");let d=(0,c.Ol)(r),i=(0,n.P)(t,(0,n._M)("date","==",d),(0,n._M)("wardId","==",a)),o=await (0,n.GG)(i);if(!o.empty){let e=o.docs[0].data();if(e.shifts&&e.shifts[s])return e.shifts[s],k({patientCensus:e.overallData||"0",overallData:e.overallData||"0",date:d,shift:s}),G(a=>({...a,patientCensus:e.overallData||"0",overallData:e.overallData||"0"})),{success:!0,data:{patientCensus:e.overallData||"0",overallData:e.overallData||"0"}}}let u=(0,n.P)(t,(0,n._M)("wardId","==",a)),m=(await (0,n.GG)(u)).docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.date<=d).sort((e,a)=>a.date.localeCompare(e.date))[0];if(m)return k({patientCensus:m.overallData||"0",overallData:m.overallData||"0",date:m.date,shift:Object.keys(m.shifts||{})[0]||""}),G(e=>({...e,patientCensus:m.overallData||"0",overallData:m.overallData||"0"})),{success:!0,data:{patientCensus:m.overallData||"0",overallData:m.overallData||"0"}};return k(null),G(e=>({...e,patientCensus:"0",overallData:"0"})),{success:!1,message:"ไม่พบข้อมูลก่อนหน้า"}}catch(e){return console.error("Error fetching previous shift data:",e),{success:!1,error:e}}finally{p(!1)}},[J,U]=(0,s.useState)(null),[F,z]=(0,s.useState)(!1),H=async()=>{try{p(!0),o().fire({title:"โหลดข้อมูลจากระบบ Approval",text:"ณารอ...",allowOutsideClick:!1,didOpen:()=>{o().showLoading()}});let e=(0,n.rJ)(l.db,"staffRecords"),a=(0,n.P)(e,(0,n._M)("date","==",(0,c.Ol)(h))),t=await (0,n.GG)(a);if(!t.empty){let e=t.docs[0].data();if(e.wards&&e.wards[x]){let a=e.wards[x];return U(a),z(!0),G(e=>({...e,patientCensus:a.numberOfPatients||"0",overallData:a.overallData||"0",nurseManager:a.nurseManager||"0",RN:a.RN||"0",PN:a.PN||"0",WC:a.WC||"0",newAdmit:a.newAdmit||"0",transferIn:a.transferIn||"0",referIn:a.referIn||"0",transferOut:a.transferOut||"0",referOut:a.referOut||"0",discharge:a.discharge||"0",dead:a.dead||"0",availableBeds:a.availableBeds||"0",unavailable:a.unavailable||"0",plannedDischarge:a.plannedDischarge||"0",comment:a.comment||"",total:a.overallData||"0"})),await o().fire({title:"ข้อมูลสำเร็จ",html:'\n                            <div class="text-left">\n                                <p class="mb-2 font-medium">ข้อมูลจากระบบ Approval สำเร็จ</p>\n                                <p class="text-sm text-gray-600">วันที่: '.concat((0,c.mI)(h),'</p>\n                                <p class="text-sm text-gray-600">Ward: ').concat(x,'</p>\n                                <p class="text-sm text-gray-600">Patient Census: ').concat(a.numberOfPatients||"0",'</p>\n                                <p class="text-sm text-gray-600">Overall Data: ').concat(a.overallData||"0","</p>\n                            </div>\n                        "),icon:"success",confirmButtonColor:"#0ab4ab"}),!0}}return await o().fire({title:"ไม่พบข้อมูล",text:"ไม่พบข้อมูลของ ".concat(x," ในวันที่ ").concat((0,c.mI)(h)," ในระบบ Approval"),icon:"info",confirmButtonColor:"#0ab4ab"}),!1}catch(e){return console.error("Error fetching approval data:",e),await o().fire({title:"ข้อผิดพลาด",text:"ไม่สามารถดึงข้อมูลจากระบบ Approval ได้",icon:"error",confirmButtonColor:"#0ab4ab"}),!1}finally{p(!1)}},K=e=>null==e?"0":"number"==typeof e?e.toString():"string"==typeof e?e:"0",Y=async(e,a)=>{try{let t=(0,n.rJ)(l.db,"wardDailyRecords"),r=(0,n.P)(t,(0,n._M)("wardId","==",a),(0,n._M)("date","==",(0,c.Ol)(e))),s=await (0,n.GG)(r);if(s.empty)P(null);else{let e=s.docs[0].data();e.approvalStatus?P(e.approvalStatus):P("pending")}}catch(e){console.error("Error checking approval status:",e),P(null)}},Q=async()=>{if(!x){o().fire({icon:"warning",title:"เลือก Ward ก่อน",text:"โปรดเลือก Ward เพื่อดึงข้อมูลล่าสุด",confirmButtonColor:"#3D6CB9"});return}try{p(!0);let e=(0,n.rJ)(l.db,"wardDailyRecords"),a=(0,n.P)(e,(0,n._M)("wardId","==",x),(0,n.My)("timestamp","desc"),(0,n.AB)(1)),t=await (0,n.GG)(a);if(t.empty)o().fire({icon:"info",title:"ไม่พบข้อมูล",text:"ไม่พบข้อมูล Ward ที่เลือก",confirmButtonColor:"#3D6CB9"});else{let e=t.docs[0].data(),a=e.date?new Date(e.date):new Date;R(a),v(a),j((0,c.mI)(a)),await V(a),o().fire({icon:"success",title:"ข้อมูลล่าสุดสำเร็จ",text:"ข้อมูลล่าสุด: ".concat((0,c.mI)(a)),confirmButtonColor:"#3D6CB9"})}}catch(e){console.error("Error fetching latest record:",e),o().fire({icon:"error",title:"ข้อผิดพลาด",text:"ไม่สามารถดึงข้อมูลล่าสุดได้",confirmButtonColor:"#3D6CB9"})}finally{p(!1)}},V=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;try{o().fire({title:"โหลดข้อมูล",text:"ข้อมูลของ ".concat(x),allowOutsideClick:!1,didOpen:()=>{o().showLoading()}}),await L(e,x),await Y(e,x);let t=(0,n.rJ)(l.db,"wardDailyRecords"),r=(0,n.P)(t,(0,n._M)("wardId","==",x),(0,n._M)("date","==",(0,c.Ol)(e))),s=await (0,n.GG)(r);if(console.log("Query results:",s.size,"documents found"),s.empty){console.log("No data found in wardDailyRecords");let a=(null==B?void 0:B.patientCensus)||"0",t=(null==B?void 0:B.overallData)||"0";G(e=>({...e,patientCensus:a,overallData:t,nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",availableBeds:"0",unavailable:"0",plannedDischarge:"0",comment:"",total:a})),z(!1);let r="ไม่พบข้อมูลของ ".concat(x," ในวันที่ ").concat((0,c.mI)(e));if(B){let e=(0,c.mI)(new Date(B.date));r+="<br><br>ข้อมูล Patient Census ล่าสุดมาจาก:<br>วันที่ ".concat(e," กะ ").concat(B.shift)}await o().fire({title:"ข้อมูลเริ่มต้น",html:"\n                        ".concat(r,'\n                        <div class="mt-4 text-left">\n                            <p class="text-sm text-gray-600">ดึงข้อมูลจากระบบ Approval ได้โดยคลิกปุ่มด้านล่าง</p>\n                        </div>\n                    '),icon:"info",showCancelButton:!0,confirmButtonText:"ดึงข้อมูลจากระบบ Approval",cancelButtonText:"ใช้ข้อมูลเริ่มต้น",confirmButtonColor:"#3085d6",cancelButtonColor:"#0ab4ab"}).then(e=>{e.isConfirmed&&H()})}else{var a;let t=s.docs[0].data(),r=(null===(a=t.shifts)||void 0===a?void 0:a[w])||{};G(e=>({...e,patientCensus:K(t.patientCensus||e.patientCensus),overallData:K(t.overallData||e.overallData),nurseManager:K(r.nurseManager),RN:K(r.RN),PN:K(r.PN),WC:K(r.WC),newAdmit:K(r.newAdmit),transferIn:K(r.transferIn),referIn:K(r.referIn),transferOut:K(r.transferOut),referOut:K(r.referOut),discharge:K(r.discharge),dead:K(r.dead),availableBeds:K(r.availableBeds),unavailable:K(r.unavailable),plannedDischarge:K(r.plannedDischarge),comment:K(r.comment),total:$({patientCensus:t.patientCensus||e.patientCensus||"0",newAdmit:r.newAdmit||"0",transferIn:r.transferIn||"0",referIn:r.referIn||"0",transferOut:r.transferOut||"0",referOut:r.referOut||"0",discharge:r.discharge||"0",dead:r.dead||"0"}).toString()})),await o().fire({title:"ข้อมูลสำเร็จ",html:'\n                        <div class="text-left">\n                            <p class="mb-2 font-medium">ข้อมูลของ '.concat(x,'</p>\n                            <p class="text-sm text-gray-600">วันที่: ').concat((0,c.mI)(e),'</p>\n                            <p class="text-sm text-gray-600">Patient Census: ').concat(t.patientCensus||"0",'</p>\n                            <p class="text-sm text-gray-600">Overall Data: ').concat(t.overallData||"0","</p>\n                            ").concat(r.nurseManager?'\n                                <div class="mt-2">\n                                    <p class="text-sm font-medium">ข้อมูลคลากร</p>\n                                    <p class="text-sm text-gray-600">Nurse Manager: '.concat(r.nurseManager,'</p>\n                                    <p class="text-sm text-gray-600">RN: ').concat(r.RN,'</p>\n                                    <p class="text-sm text-gray-600">PN: ').concat(r.PN,'</p>\n                                    <p class="text-sm text-gray-600">WC: ').concat(r.WC,"</p>\n                                </div>\n                            "):"","\n                        </div>\n                    "),icon:"success",confirmButtonColor:"#0ab4ab"}),z(!1)}}catch(e){console.error("Error fetching ward data:",e),await o().fire({title:"ข้อผิดพลาด",text:e.message||"ไม่สามารถดึงข้อมูลหอพักได้",icon:"error",confirmButtonColor:"#0ab4ab"})}},Z=e=>{let{name:a,value:t}=e.target;G(e=>{let r=t;"comment"!==a&&""===t&&(r="0");let s={...e,[a]:r};if(["patientCensus","newAdmit","transferIn","referIn","transferOut","referOut","discharge","dead"].includes(a)){let e=$(s);s.total=e.toString(),s.overallData=e.toString()}return s})},q=async e=>{try{let a=new Date(e);if(x){let e=(0,n.rJ)(l.db,"wardDailyRecords"),t=(0,c.Ol)(a),r=(0,n.P)(e,(0,n._M)("date","==",t),(0,n._M)("wardId","==",x)),s=await (0,n.GG)(r);if(s.empty)v(a),j((0,c.mI)(a)),await L(a,x),await V();else{let e=s.docs[0].data();if(e.shifts&&e.shifts[w]){let e=await o().fire({title:"พบข้อมูลอยู่แล้ว",html:'\n                                <div class="text-left">\n                                    <p class="mb-2">ข้อมูลของ <b>'.concat(x,"</b> ในวันที่ <b>").concat((0,c.mI)(a),"</b> กะ <b>").concat(w,'</b> อยู่ในระบบแล้ว</p>\n                                    <p class="mb-4">ต้องการอย่างไร?</p>\n                                    <ul class="list-disc pl-5 text-sm text-gray-600">\n                                        <li>ดึงข้อมูล: จะโหลดข้อมูลที่มีอยู่ก่อน</li>\n                                        <li>สร้างข้อมูลใหม่: จะล้างค่าทั้งหมดและให้กรอกใหม่</li>\n                                        <li>ยกเลิก: จะยกเลิกการเปลี่ยนแปลง</li>\n                                    </ul>\n                                </div>\n                            '),icon:"warning",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"ดึงข้อมูล",denyButtonText:"สร้างข้อมูลใหม่",cancelButtonText:"ยกเลิก",confirmButtonColor:"#0ab4ab",denyButtonColor:"#3085d6",cancelButtonColor:"#d33"});if(e.isConfirmed)v(a),j((0,c.mI)(a)),await L(a,x),await V();else{if(!e.isDenied)return;v(a),j((0,c.mI)(a)),G({patientCensus:"0",overallData:"0",nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",availableBeds:"0",unavailable:"0",plannedDischarge:"0",comment:"",total:"0"}),await L(a,x)}}else v(a),j((0,c.mI)(a)),await L(a,x),await V()}}else v(a),j((0,c.mI)(a));D(!1)}catch(e){console.error("Error in handleDateSelect:",e),await o().fire({title:"ข้อผิดพลาด",text:"ไม่สามารถตรวจสอบข้อมูลได้ ลองใหม่ครั้ง",icon:"error",confirmButtonColor:"#0ab4ab"})}},X=async e=>{e.preventDefault(),p(!0);try{if(!x)throw Error("Ward");if(!h)throw Error("วันที่");if(!w)throw Error("กะการทำงาน");let e=(0,n.rJ)(l.db,"wardDailyRecords"),a=(0,n.P)(e,(0,n._M)("wardId","==",x),(0,n._M)("date","==",(0,c.Ol)(h))),r=await (0,n.GG)(a);if(!r.empty&&!(await o().fire({title:"พบข้อมูลซ้ำ",html:'\n                        <div class="text-left">\n                            <p class="mb-2">พบข้อมูลของ '.concat(x,'</p>\n                            <p class="mb-2">วันที่: ').concat((0,c.mI)(h),'</p>\n                            <p class="text-sm text-gray-600">ต้องการดึงข้อมูลหรือไม่?</p>\n                        </div>\n                    '),icon:"warning",showCancelButton:!0,confirmButtonText:"ดึงข้อมูล",cancelButtonText:"ยกเลิก",confirmButtonColor:"#0ab4ab",cancelButtonColor:"#d33"})).isConfirmed){p(!1);return}let s=$().toString(),d=(null==t?void 0:t.username)||"Unknown User",i={wardId:x,date:(0,c.Ol)(h),patientCensus:E.patientCensus||"0",overallData:s,lastUpdated:(0,n.O5)(),approvalStatus:"pending",shifts:{[w]:{nurseManager:E.nurseManager,RN:E.RN,PN:E.PN,WC:E.WC,newAdmit:E.newAdmit,transferIn:E.transferIn,referIn:E.referIn,transferOut:E.transferOut,referOut:E.referOut,discharge:E.discharge,dead:E.dead,availableBeds:E.availableBeds,unavailable:E.unavailable,plannedDischarge:E.plannedDischarge,comment:E.comment,recorderName:d,updatedAt:(0,n.O5)()}},sourceFromApproval:F,approvalDataId:(null==J?void 0:J.id)||null};if(r.empty)await (0,n.gS)(e,i);else{let e=r.docs[0].ref,a=r.docs[0].data();await (0,n.mZ)(e,{patientCensus:E.patientCensus||"0",overallData:s,lastUpdated:(0,n.O5)(),approvalStatus:"pending",shifts:{...a.shifts,[w]:{nurseManager:E.nurseManager,RN:E.RN,PN:E.PN,WC:E.WC,newAdmit:E.newAdmit,transferIn:E.transferIn,referIn:E.referIn,transferOut:E.transferOut,referOut:E.referOut,discharge:E.discharge,dead:E.dead,availableBeds:E.availableBeds,unavailable:E.unavailable,plannedDischarge:E.plannedDischarge,comment:E.comment,recorderName:d,updatedAt:(0,n.O5)()}}})}M(!1),P("pending"),await o().fire({title:"ข้อมูลสำเร็จ",html:'\n                    <div>\n                        <p>ข้อมูลถูกบันทึกแล้ว</p>\n                        <p class="text-sm text-blue-600 mt-2">รอการ Approval จาก Supervisor</p>\n                    </div>\n                ',icon:"success",confirmButtonColor:"#0ab4ab"}),k(null),G({patientCensus:"0",overallData:"0",nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",availableBeds:"0",unavailable:"0",plannedDischarge:"0",comment:"",total:"0"}),await V()}catch(e){console.error("Error saving ward data:",e),await o().fire({title:"ข้อผิดพลาด",text:e.message||"ไม่สามารถบันทึกข้อมูลได้ ลองใหม่ครั้ง",icon:"error",confirmButtonColor:"#0ab4ab"})}finally{p(!1)}},$=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,{patientCensus:a=0,newAdmit:t=0,transferIn:r=0,referIn:s=0,transferOut:l=0,referOut:n=0,discharge:d=0,dead:i=0}=e;return Math.max(0,parseInt(a)+parseInt(t)+parseInt(r)+parseInt(s)+parseInt(l)-parseInt(n)-parseInt(d)-parseInt(i))};return i?(0,r.jsx)(d.A,{}):(0,r.jsx)("div",{className:"container mx-auto px-4 py-8 bg-gradient-to-br from-blue-50 to-teal-50",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 border border-blue-100",children:[(0,r.jsx)("div",{className:"text-center mb-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("img",{src:"/images/BPK.jpg",alt:"BPK Logo",className:"w-10 h-10 object-contain"}),(0,r.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-500 to-teal-500 text-transparent bg-clip-text mb-1",children:"Daily Patient Census and Staffing"})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Ward:"}),(0,r.jsxs)("select",{value:x,onChange:e=>g(e.target.value),className:"w-full border border-blue-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-blue-50",disabled:!!a,children:[(0,r.jsx)("option",{value:"",children:"-- เลือก Ward --"}),["Ward6","Ward7","Ward8","Ward9","WardGI","Ward10B","Ward11","Ward12","ICU","CCU","LR","NSY"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"วันที่:"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:N,readOnly:!0,className:"w-full border border-blue-200 rounded-lg px-4 py-2 cursor-pointer bg-blue-50",onClick:()=>D(!C)}),C&&(0,r.jsxs)("div",{className:"absolute z-10 mt-1 bg-white shadow-lg rounded-lg p-2 border border-blue-200",children:[(0,r.jsx)(m.A,{selectedDate:h,onDateSelect:q,datesWithData:I}),(0,r.jsx)("button",{className:"mt-2 w-full py-1 bg-blue-100 rounded-md text-sm text-blue-700 hover:bg-blue-200",onClick:()=>D(!1),children:"ปิดปฏิทิน"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"กะ:"}),(0,r.jsx)(b.A,{selectedShift:w,onShiftChange:e=>{y(e)}})]})]}),W&&(0,r.jsx)("div",{className:"mb-4 p-3 rounded-lg bg-teal-50 text-teal-700 border border-teal-200",children:(0,r.jsxs)("p",{className:"font-medium text-center",children:["ข้อมูลล่าสุด: ",(0,c.mI)(W)]})}),S&&(0,r.jsx)("div",{className:"mb-4 p-3 rounded-lg ".concat("approved"===S?"bg-green-100 text-green-700 border border-green-200":"rejected"===S?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"),children:(0,r.jsx)("p",{className:"font-medium text-center",children:"approved"===S?"ได้รับการอนุมัติแล้ว":"rejected"===S?"ถูกปฏิเสธ":"รอการอนุมัติ"})}),(0,r.jsxs)("div",{className:"flex flex-wrap justify-center gap-4 mb-6",children:[(0,r.jsx)(()=>(0,r.jsx)("div",{className:"mb-4 flex justify-center",children:(0,r.jsxs)("button",{type:"button",onClick:Q,className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50 shadow-sm flex items-center gap-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"ดึงข้อมูลล่าสุด"]})}),{}),(0,r.jsx)(()=>x?(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center",children:[(0,r.jsx)("button",{type:"button",onClick:H,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 shadow-md text-sm",children:"ดึงข้อมูลจากระบบ Approval"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"ใช้เมื่อต้องการดึงข้อมูลคลากรจากระบบ Approval โดยตรง"})]}):null,{})]}),(0,r.jsxs)("form",{onSubmit:X,children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-5 rounded-lg border border-blue-200 mb-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-medium mb-4 text-blue-700",children:"ข้อมูลผู้ป่วย"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Patient Census (จากกะก่อนหน้า):"}),(0,r.jsx)("input",{type:"number",name:"patientCensus",value:E.patientCensus,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"จำนวนผู้ป่วย (คำนวณ):"}),(0,r.jsx)("input",{type:"text",value:E.total,readOnly:!0,className:"w-full border border-teal-200 bg-teal-50 rounded-lg px-4 py-2 shadow-sm text-teal-700 font-medium"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"New Admit:"}),(0,r.jsx)("input",{type:"number",name:"newAdmit",value:E.newAdmit,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Transfer In:"}),(0,r.jsx)("input",{type:"number",name:"transferIn",value:E.transferIn,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Refer In:"}),(0,r.jsx)("input",{type:"number",name:"referIn",value:E.referIn,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Planned Discharge:"}),(0,r.jsx)("input",{type:"number",name:"plannedDischarge",value:E.plannedDischarge,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Transfer Out:"}),(0,r.jsx)("input",{type:"number",name:"transferOut",value:E.transferOut,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Refer Out:"}),(0,r.jsx)("input",{type:"number",name:"referOut",value:E.referOut,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Discharge:"}),(0,r.jsx)("input",{type:"number",name:"discharge",value:E.discharge,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Dead:"}),(0,r.jsx)("input",{type:"number",name:"dead",value:E.dead,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Available Beds:"}),(0,r.jsx)("input",{type:"number",name:"availableBeds",value:E.availableBeds,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Unavailable:"}),(0,r.jsx)("input",{type:"number",name:"unavailable",value:E.unavailable,onChange:Z,className:"w-full border border-blue-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]})]})]}),(0,r.jsxs)("div",{className:"bg-teal-50 p-5 rounded-lg border border-teal-200 mb-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-medium mb-4 text-teal-700",children:"ข้อมูลคลากร"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Nurse Manager:"}),(0,r.jsx)("input",{type:"number",name:"nurseManager",value:E.nurseManager,onChange:Z,className:"w-full border border-teal-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"RN:"}),(0,r.jsx)("input",{type:"number",name:"RN",value:E.RN,onChange:Z,className:"w-full border border-teal-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"PN:"}),(0,r.jsx)("input",{type:"number",name:"PN",value:E.PN,onChange:Z,className:"w-full border border-teal-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"WC:"}),(0,r.jsx)("input",{type:"number",name:"WC",value:E.WC,onChange:Z,className:"w-full border border-teal-300 rounded-lg px-4 py-2 bg-white shadow-sm"})]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"หมายเหตุ:"}),(0,r.jsx)("textarea",{name:"comment",value:E.comment,onChange:Z,className:"w-full border border-gray-300 rounded-lg px-4 py-2 min-h-[100px] bg-white shadow-sm",placeholder:"หมายเหตุ (ถ้ามี)"})]}),(0,r.jsxs)("div",{className:"mb-6 bg-blue-50/80 rounded-xl p-5 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-blue-800 mb-4 bg-white/50 py-2 px-4 rounded-lg text-center shadow-sm",children:"เจ้าหน้าที่บันทึกข้อมูล"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-blue-700",children:"First Name"}),(0,r.jsx)("input",{type:"text",name:"recorderFirstName",value:(null==t?void 0:t.username)||"",readOnly:!0,className:"w-full text-black px-3 py-2 border border-blue-200 rounded-lg bg-white/70",placeholder:"ชื้อ"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-blue-700",children:"Department"}),(0,r.jsx)("input",{type:"text",value:(null==t?void 0:t.department)||"",readOnly:!0,className:"w-full text-black px-3 py-2 border border-blue-200 rounded-lg bg-white/70",placeholder:"แผนก"})]})]})]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-teal-500 text-white rounded-lg hover:from-blue-600 hover:to-teal-600 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50 shadow-md",disabled:!x,children:"บันทึกข้อมูล"})})]})]})})}}}]);