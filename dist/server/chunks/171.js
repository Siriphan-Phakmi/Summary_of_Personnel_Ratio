exports.id=171,exports.ids=[171],exports.modules={6171:(e,a,t)=>{"use strict";t.d(a,{A:()=>N});var r=t(5512),s=t(8009),n=t(3104),l=t(7656);t(9863);let i={Ward6:"Ward 6",Ward7:"Ward 7",Ward8:"Ward 8",Ward9:"Ward 9",WardGI:"Ward GI",Ward10B:"Ward 10B",Ward11:"Ward 11",Ward12:"Ward 12",ICU:"ICU",CCU:"CCU",LR:"LR",NSY:"NSY"},d=["Ward6","Ward7","Ward8","Ward9","WardGI","Ward10B","Ward11","Ward12","ICU","CCU","LR","NSY"],o={numberOfPatients:"0",nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",overallData:"0",availableBeds:"0",plannedDischarge:"0",unavailable:"0",comment:""};var c=t(2720);let m=({wardId:e,date:a,status:t="pending"})=>{let[i,d]=(0,s.useState)(!1),o=async()=>{try{if(d(!0),!(await c.A.fire({title:"Approve Ward Data",html:`
          <div class="text-left">
            <p class="mb-2 font-medium">Are you sure you want to approve data for ${e}?</p>
            <p class="text-sm text-gray-600">Date: ${a}</p>
          </div>
        `,icon:"question",showCancelButton:!0,confirmButtonText:"Approve",cancelButtonText:"Cancel",confirmButtonColor:"#0ab4ab",cancelButtonColor:"#d33"})).isConfirmed){d(!1);return}let t=(0,l.H9)(n.db,"wardDailyRecords",`${a}_${e}`);await (0,l.mZ)(t,{approvalStatus:"approved",approvedAt:new Date().toISOString()}),await c.A.fire({title:"Approved Successfully",text:`Data for ${e} has been approved`,icon:"success",confirmButtonColor:"#0ab4ab"})}catch(e){console.error("Error approving ward data:",e),await c.A.fire({title:"Error",text:"Failed to approve ward data. Please try again.",icon:"error",confirmButtonColor:"#0ab4ab"})}finally{d(!1)}},m=async()=>{try{d(!0);let t=await c.A.fire({title:"Reject Ward Data",html:`
          <div class="text-left">
            <p class="mb-2 font-medium">Please provide a reason for rejection:</p>
            <textarea id="rejection-reason" class="w-full px-3 py-2 border border-gray-300 rounded-md" rows="3"></textarea>
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonText:"Reject",cancelButtonText:"Cancel",confirmButtonColor:"#d33",cancelButtonColor:"#0ab4ab",preConfirm:()=>{let e=document.getElementById("rejection-reason").value;return e.trim()||c.A.showValidationMessage("Please provide a reason for rejection"),e}});if(!t.isConfirmed){d(!1);return}let r=t.value,s=(0,l.H9)(n.db,"wardDailyRecords",`${a}_${e}`);await (0,l.mZ)(s,{approvalStatus:"rejected",rejectedAt:new Date().toISOString(),rejectionReason:r}),await c.A.fire({title:"Rejected Successfully",text:`Data for ${e} has been rejected`,icon:"info",confirmButtonColor:"#0ab4ab"})}catch(e){console.error("Error rejecting ward data:",e),await c.A.fire({title:"Error",text:"Failed to reject ward data. Please try again.",icon:"error",confirmButtonColor:"#0ab4ab"})}finally{d(!1)}};return"approved"===t?(0,r.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1 text-green-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Approved"]}):"rejected"===t?(0,r.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),"Rejected"]}):(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:o,disabled:i,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:i?"Processing...":"Approve"}),(0,r.jsx)("button",{onClick:m,disabled:i,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:i?"Processing...":"Reject"})]})},u=({WARD_ORDER:e,formData:a,handleInputChange:t,displayValue:s,approvalStatuses:n={},selectedDate:l})=>(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("div",{className:"inline-flex gap-1 min-w-max p-1",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h3",{className:"text-xs font-bold text-gray-700 font-THSarabun",children:"Wards"})}),e.map(e=>(0,r.jsx)("div",{className:"h-8 flex items-center",children:(0,r.jsx)("span",{className:"text-xs font-semibold text-[#0ab4ab] font-THSarabun whitespace-nowrap",children:i[e]||e})},e)),(0,r.jsx)("div",{className:"h-8 flex items-center",children:(0,r.jsx)("span",{className:"text-xs font-semibold text-purple-600 font-THSarabun",children:"Total"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-700 font-THSarabun",children:"Patient Census"})}),e.map(e=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-[#0ab4ab]/20 to-[#0ab4ab]/10 rounded-md p-1 text-[#0ab4ab] shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.wards[e]?.numberOfPatients),className:"w-16 text-center text-sm font-bold bg-gray-100 border-b border-[#0ab4ab] focus:outline-none text-[#0ab4ab] placeholder-[#0ab4ab]/50 font-THSarabun cursor-not-allowed",placeholder:"0",readOnly:!0,disabled:!0})})},e)),(0,r.jsx)("div",{className:"bg-gradient-to-r from-purple-400 to-purple-500 rounded-md p-1 text-white shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.totals.numberOfPatients),readOnly:!0,className:"w-16 text-center text-sm font-bold bg-transparent border-b border-white focus:outline-none text-white font-THSarabun",placeholder:"0"})})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-700 font-THSarabun",children:"Overall Data"})}),e.map(e=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-400/20 to-blue-500/10 rounded-md p-1 text-blue-600 shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.wards[e]?.overallData),className:"w-16 text-center text-sm font-bold bg-gray-100 border-b border-blue-500 focus:outline-none text-blue-600 placeholder-blue-300 font-THSarabun cursor-not-allowed",placeholder:"0",readOnly:!0,disabled:!0})})},e)),(0,r.jsx)("div",{className:"bg-gradient-to-r from-purple-400 to-purple-500 rounded-md p-1 text-white shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.totals.overallData),readOnly:!0,className:"w-16 text-center text-sm font-bold bg-transparent border-b border-white focus:outline-none text-white font-THSarabun",placeholder:"0"})})})]}),Object.entries({"Nurse Manager":"nurseManager",RN:"RN",PN:"PN",WC:"WC"}).map(([n,l])=>(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-700 font-THSarabun",children:n})}),e.map(e=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-green-400/20 to-green-500/10 rounded-md p-1 text-green-600 shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.wards[e]?.[l]),onChange:a=>t("staff",e,{[l]:a.target.value}),className:"w-16 text-center text-sm font-bold bg-white border-b border-green-500 focus:outline-none focus:border-green-500 text-black placeholder-green-300 font-THSarabun",placeholder:"0",min:"0"})})},e)),(0,r.jsx)("div",{className:"bg-gradient-to-r from-purple-400 to-purple-500 rounded-md p-1 text-white shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.totals[l]),readOnly:!0,className:"w-16 text-center text-sm font-bold bg-transparent border-b border-white focus:outline-none text-white font-THSarabun",placeholder:"0"})})})]},l)),Object.entries({"New Admit":"newAdmit","Transfer In":"transferIn","Refer In":"referIn","Transfer Out":"transferOut","Refer Out":"referOut",Discharge:"discharge",Dead:"dead"}).map(([n,l])=>(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-700 font-THSarabun",children:n})}),e.map(e=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-yellow-400/20 to-yellow-500/10 rounded-md p-1 text-yellow-600 shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.wards[e]?.[l]),onChange:a=>t("movement",e,{[l]:a.target.value}),className:"w-16 text-center text-sm font-bold bg-white border-b border-yellow-500 focus:outline-none focus:border-yellow-500 text-black placeholder-yellow-300 font-THSarabun",placeholder:"0",min:"0"})})},e)),(0,r.jsx)("div",{className:"bg-gradient-to-r from-purple-400 to-purple-500 rounded-md p-1 text-white shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.totals[l]),readOnly:!0,className:"w-16 text-center text-sm font-bold bg-transparent border-b border-white focus:outline-none text-white font-THSarabun",placeholder:"0"})})})]},l)),Object.entries({Available:"availableBeds",Unavailable:"unavailable","Planned Discharge":"plannedDischarge"}).map(([n,l])=>(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-700 font-THSarabun",children:n})}),e.map(e=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-pink-400/20 to-pink-500/10 rounded-md p-1 text-pink-600 shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.wards[e]?.[l]),onChange:a=>t("info",e,{[l]:a.target.value}),className:"w-16 text-center text-sm font-bold bg-white border-b border-pink-500 focus:outline-none focus:border-pink-500 text-black placeholder-pink-300 font-THSarabun",placeholder:"0",min:"0"})})},e)),(0,r.jsx)("div",{className:"bg-gradient-to-r from-purple-400 to-purple-500 rounded-md p-1 text-white shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"number",value:s(a.totals[l]),readOnly:!0,className:"w-16 text-center text-sm font-bold bg-transparent border-b border-white focus:outline-none text-white font-THSarabun",placeholder:"0"})})})]},l)),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-700 font-THSarabun",children:"Comment"})}),e.map(e=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-gray-100 to-gray-200 rounded-md p-1 shadow h-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("input",{type:"text",value:a.wards[e]?.comment||"",onChange:a=>t("comment",e,{comment:a.target.value}),className:"w-24 text-center text-xs bg-white border-b border-gray-400 focus:outline-none focus:border-gray-600 text-black placeholder-gray-300 font-THSarabun",placeholder:"Add comment..."})})},e)),(0,r.jsx)("div",{className:"h-8"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-12 flex items-center justify-center",children:(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-700 font-THSarabun",children:"Approval Status"})}),e.map(e=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-100 to-blue-200 rounded-md p-1 shadow h-8",children:(0,r.jsx)("div",{className:"text-center flex justify-center items-center",children:n[e]?(0,r.jsx)(m,{wardId:e,date:l,status:n[e]}):(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"No data"})})},e)),(0,r.jsx)("div",{className:"h-8"})]})]})}),f=({label:e,oldValue:a,newValue:t})=>(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 py-1",children:[(0,r.jsx)("div",{className:"text-sm text-gray-600",children:e}),(0,r.jsx)("div",{className:"text-sm text-purple-600",children:a||"-"}),(0,r.jsx)("div",{className:"text-sm text-pink-600",children:t||"-"})]}),x=({showDataComparison:e,existingData:a,formData:t,summaryData:s,setShowDataComparison:n,saveData:l,WARD_ORDER:i})=>e&&a?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-medium mb-4",children:"Data Comparison"}),(0,r.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"font-medium text-lg mb-2",children:e}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-2",children:[(0,r.jsx)("div",{className:"font-medium",children:"Field"}),(0,r.jsx)("div",{className:"font-medium",children:"Current"}),(0,r.jsx)("div",{className:"font-medium",children:"New"})]}),(0,r.jsx)("div",{className:"space-y-1",children:(0,r.jsx)(f,{label:"Patient Census",oldValue:a?.wards?.[e]?.numberOfPatients,newValue:t?.wards?.[e]?.numberOfPatients})})]},e))}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-4",children:[(0,r.jsx)("button",{onClick:()=>n(!1),className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),(0,r.jsx)("button",{onClick:l,className:"px-4 py-2 text-white bg-blue-500 rounded-lg hover:bg-blue-600",children:"Save Changes"})]})]})}):null;var b=t(3518);let h=({summaryData:e,setSummaryData:a})=>(0,r.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6",children:(0,r.jsx)("div",{className:"grid grid-cols-1 gap-8",children:(0,r.jsxs)("div",{className:"bg-green-50/80 rounded-xl p-5 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-4 bg-white/50 py-2 px-4 rounded-lg text-center shadow-sm",children:"Supervisor Signature"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-green-700",children:"First Name"}),(0,r.jsx)("input",{type:"text",value:e.supervisorFirstName,onChange:e=>a(a=>({...a,supervisorFirstName:e.target.value})),className:"w-full text-black px-3 py-2 border border-green-200 rounded-lg focus:ring-2 focus:ring-green-300 focus:border-green-300 bg-white/70",placeholder:"ชื่อ"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-green-700",children:"Last Name"}),(0,r.jsx)("input",{type:"text",value:e.supervisorLastName,onChange:e=>a(a=>({...a,supervisorLastName:e.target.value})),className:"w-full text-black px-3 py-2 border border-green-200 rounded-lg focus:ring-2 focus:ring-green-300 focus:border-green-300 bg-white/70",placeholder:"นามสกุล"})]})]})]})})}),p=({summaryData:e,setSummaryData:a})=>(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-center mb-6 text-indigo-800 bg-white/50 py-2 rounded-lg shadow-sm",children:"ข้อมูลสรุป 24 ชั่วโมง"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"bg-pink-50 rounded-xl p-4 shadow-sm transition-all hover:shadow-md",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-pink-700 mb-2",children:"OPD 24hr"}),(0,r.jsx)("input",{type:"number",value:e.opdTotal24hr,onChange:e=>a(a=>({...a,opdTotal24hr:e.target.value})),className:"w-full text-black px-3 py-2 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-300 focus:border-pink-300 bg-white/70",placeholder:"0"})]}),(0,r.jsxs)("div",{className:"bg-purple-50 rounded-xl p-4 shadow-sm transition-all hover:shadow-md",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"Old Patient"}),(0,r.jsx)("input",{type:"number",value:e.existingPatients,onChange:e=>a(a=>({...a,existingPatients:e.target.value})),className:"w-full text-black px-3 py-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-300 focus:border-purple-300 bg-white/70",placeholder:"0"})]}),(0,r.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 shadow-sm transition-all hover:shadow-md",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"New Patient"}),(0,r.jsx)("input",{type:"number",value:e.newPatients,onChange:e=>a(a=>({...a,newPatients:e.target.value})),className:"w-full text-black px-3 py-2 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-300 focus:border-blue-300 bg-white/70",placeholder:"0"})]}),(0,r.jsxs)("div",{className:"bg-teal-50 rounded-xl p-4 shadow-sm transition-all hover:shadow-md",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-teal-700 mb-2",children:"Admit 24hr"}),(0,r.jsx)("input",{type:"number",value:e.admissions24hr,onChange:e=>a(a=>({...a,admissions24hr:e.target.value})),className:"w-full text-black px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-300 focus:border-teal-300 bg-white/70",placeholder:"0"})]})]})]});var g=t(2575);let v=({showCalendar:e,setShowCalendar:a,selectedDate:t,setSelectedDate:s,formData:n,setFormData:l,thaiDate:i,setThaiDate:d,fetchPreviousShiftData:o,handleShiftChange:m,datesWithData:u,checkExistingData:f,setSummaryData:x})=>(0,r.jsxs)("div",{className:"bg-gradient-to-br from-[#0ab4ab]/5 via-blue-50 to-purple-50 rounded-2xl p-4 mb-3 shadow-lg",children:[(0,r.jsxs)("div",{className:"text-center mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("img",{src:"/images/BPK.jpg",alt:"BPK Logo",className:"w-8 h-8 object-contain"}),(0,r.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-[#0ab4ab] to-blue-600 text-transparent bg-clip-text mb-1",children:"Daily Patient Census and Staffing"})]}),(0,r.jsx)("div",{className:"h-0.5 w-24 mx-auto bg-gradient-to-r from-[#0ab4ab] to-blue-600 rounded-full"})]}),(0,r.jsx)("div",{className:"space-y-3",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsx)("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-3 shadow-sm hover:shadow-md transition-all",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>a(!e),className:"w-full md:w-auto px-4 py-2 bg-gradient-to-r from-[#0ab4ab] to-blue-500 text-white rounded-lg hover:from-[#0ab4ab]/90 hover:to-blue-600 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-[#0ab4ab] focus:ring-opacity-50 shadow-md text-sm",children:e?"ซ่อนปฏิทิน":"เลือกวันที่"}),(0,r.jsxs)("div",{className:"text-gray-700 space-y-0.5 text-center md:text-left text-sm",children:[(0,r.jsxs)("div",{className:"font-medium text-[#0ab4ab]",children:["วันที่ปัจจุบัน : ",(0,b.mI)(new Date)]}),(0,r.jsxs)("div",{className:"text-blue-600",children:["อัพเดทข้อมูลล่าสุด : ",i]})]})]})}),(0,r.jsx)("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-3 shadow-sm hover:shadow-md transition-all",children:(0,r.jsx)("div",{className:"flex flex-col md:flex-row justify-center gap-4",children:["07:00-19:00","19:00-07:00"].map(e=>(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsxs)("label",{className:"relative flex items-center gap-2 cursor-pointer group",children:[(0,r.jsx)("input",{type:"radio",name:"shift",value:e,checked:n.shift===e,onChange:e=>m(e.target.value),className:"hidden"}),(0,r.jsx)("div",{className:`w-4 h-4 rounded-full border-2 transition-all ${n.shift===e?"border-[#0ab4ab] bg-[#0ab4ab]":"border-gray-300 group-hover:border-[#0ab4ab]/50"}`,children:n.shift===e&&(0,r.jsx)("div",{className:"w-1.5 h-1.5 bg-white rounded-full m-auto mt-0.5"})}),(0,r.jsxs)("span",{className:`text-sm transition-colors ${n.shift===e?"text-[#0ab4ab] font-medium":"text-gray-600"}`,children:["07:00-19:00"===e?"เช้า":"ดึก"," (",e,")",e===n.shift&&(0,r.jsx)("span",{className:"ml-1 text-xs px-1.5 py-0.5 bg-[#0ab4ab]/10 text-[#0ab4ab] rounded-full",children:"กะที่เลือกก่อนหน้านั้น"})]})]})},e))})})]})}),e&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:(0,r.jsx)("div",{className:"relative bg-white rounded-2xl shadow-2xl transform transition-all",children:(0,r.jsx)(g.A,{selectedDate:t,datesWithData:u,onDateSelect:async e=>{let t=new Date(e);t.setHours(0,0,0,0);let r=t.getTimezoneOffset();t.setMinutes(t.getMinutes()-r);let i=t.toISOString().split("T")[0];!await f(i,n.shift)&&(await c.A.fire({title:"ยืนยันการเปลี่ยนวันที่",html:`
                                            <div class="text-left">
                                                <p class="font-semibold mb-2">ข้อมูลต่อไปนี้จะถูกล้าง:</p>
                                                <ul class="list-disc pl-5 space-y-1 text-sm">
                                                    <li>ข้อมูลเจ้าหน้าที่ (Nurse Manager, RN, PN, WC)</li>
                                                    <li>ข้อมูลการเคลื่อนย้ายผู้ป่วย</li>
                                                    <li>ข้อมูลเตียง</li>
                                                    <li>Comments</li>
                                                    <li>ข้อมูลสรุป 24 ชั่วโมง</li>
                                                    <li>ลายเซ็นผู้ตรวจการและผู้บันทึก</li>
                                                </ul>
                                                <p class="mt-4 text-sm text-gray-600">*Patient Census และ Overall Data จะถูกคำนวณใหม่</p>
                                            </div>
                                        `,icon:"warning",showCancelButton:!0,confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",confirmButtonColor:"#0ab4ab",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed&&(await o(i,n.shift),l(e=>{let a={};return Object.entries(e.wards).forEach(([e,t])=>{a[e]={numberOfPatients:t.numberOfPatients,overallData:t.overallData,nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",availableBeds:"0",unavailable:"0",plannedDischarge:"0",comment:""}}),{...e,date:i,wards:a}}),x({opdTotal24hr:"",existingPatients:"",newPatients:"",admissions24hr:"",supervisorFirstName:"",supervisorLastName:"",recorderFirstName:"",recorderLastName:""}),s(t),d((0,b.mI)(t)),a(!1),await c.A.fire({title:"ล้างข้อมูลสำเร็จ",text:"ระบบได้ล้างข้อมูลและคงค่า Patient Census และ Overall Data ไว้",icon:"success",confirmButtonColor:"#0ab4ab"}))},onClickOutside:()=>a(!1),variant:"form"})})})]});var w=t(9334);let N=()=>{let e=(0,w.useRouter)(),[a,t]=(0,s.useState)(0),[i,m]=(0,s.useState)(!0),[f,g]=(0,s.useState)(!1),[N,j]=(0,s.useState)(!1),[y,D]=(0,s.useState)(new Date),[C,O]=(0,s.useState)([]),[B,I]=(0,s.useState)(""),[S,P]=(0,s.useState)({opdTotal24hr:"",existingPatients:"",newPatients:"",admissions24hr:"",supervisorFirstName:"",supervisorLastName:""}),[k,T]=(0,s.useState)({date:"",shift:"",wards:{Ward6:{...o},Ward7:{...o},Ward8:{...o},Ward9:{...o},WardGI:{...o},Ward10B:{...o},Ward11:{...o},Ward12:{...o},ICU:{...o},CCU:{...o},LR:{...o},NSY:{...o}},totals:{...o}}),[A,W]=(0,s.useState)(!1),[R,M]=(0,s.useState)(null),[E,L]=(0,s.useState)({initialLoading:!0,savingData:!1,checkingDuplicates:!1,fetchingDates:!1}),[H,$]=(0,s.useState)(""),[F,G]=(0,s.useState)(!1),[_,z]=(0,s.useState)(!1),[U,Y]=(0,s.useState)({});(0,s.useEffect)(()=>{let e=()=>window.innerWidth<768,a=()=>{z(e())};return z(e()),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),(0,s.useEffect)(()=>{setTimeout(()=>{m(!1)},1e3)},[]);let V=async e=>{try{if(!e)return;let a=(0,b.Ol)(new Date(e)),t=(0,l.rJ)(n.db,"wardDailyRecords"),r={};for(let e of d){let s=(0,l.P)(t,(0,l._M)("date","==",a),(0,l._M)("wardId","==",e)),n=await (0,l.GG)(s);if(n.empty)r[e]=null;else{let a=n.docs[0].data();r[e]=a.approvalStatus||"pending"}}Y(r),console.log("Fetched approval statuses:",r)}catch(e){console.error("Error fetching approval statuses:",e)}};(0,s.useEffect)(()=>{},[]);let[J,K]=(0,s.useState)(!1),[q,Z]=(0,s.useState)(!1),Q=async e=>{try{let a=(0,l.rJ)(n.db,"staffRecords"),t=(0,l.P)(a,(0,l._M)("date","==",e)),r=await (0,l.GG)(t),s=new Set(r.docs.map(e=>e.data().shift));return{hasMorningShift:s.has("07:00-19:00"),hasNightShift:s.has("19:00-07:00")}}catch(e){return console.error("Error checking date shifts:",e),{hasMorningShift:!1,hasNightShift:!1}}},X=(0,s.useMemo)(()=>Object.values(k.wards).reduce((e,a)=>({numberOfPatients:e.numberOfPatients+(Number(a.numberOfPatients)||0),nurseManager:e.nurseManager+(Number(a.nurseManager)||0),RN:e.RN+(Number(a.RN)||0),PN:e.PN+(Number(a.PN)||0),WC:e.WC+(Number(a.WC)||0),newAdmit:e.newAdmit+(Number(a.newAdmit)||0),transferIn:e.transferIn+(Number(a.transferIn)||0),referIn:e.referIn+(Number(a.referIn)||0),transferOut:e.transferOut+(Number(a.transferOut)||0),referOut:e.referOut+(Number(a.referOut)||0),discharge:e.discharge+(Number(a.discharge)||0),dead:e.dead+(Number(a.dead)||0),overallData:e.overallData+(Number(a.overallData)||0),availableBeds:e.availableBeds+(Number(a.availableBeds)||0),unavailable:e.unavailable+(Number(a.unavailable)||0),plannedDischarge:e.plannedDischarge+(Number(a.plannedDischarge)||0)}),{numberOfPatients:0,nurseManager:0,RN:0,PN:0,WC:0,newAdmit:0,transferIn:0,referIn:0,transferOut:0,referOut:0,discharge:0,dead:0,overallData:0,availableBeds:0,unavailable:0,plannedDischarge:0}),[k.wards]);(0,s.useEffect)(()=>{T(e=>({...e,totals:X}))},[X]);let ee=(0,s.useCallback)((e,a,t)=>{T(e=>{let r={...e.wards[a],...t},s=parseInt(r.numberOfPatients||"0"),n=parseInt(r.newAdmit||"0"),l=parseInt(r.transferIn||"0"),i=parseInt(r.referIn||"0"),d=parseInt(r.transferOut||"0"),o=Math.max(0,s+n+l+i+d-parseInt(r.referOut||"0")-parseInt(r.discharge||"0")-parseInt(r.dead||"0")).toString();r.overallData=o;let c={...e.wards,[a]:r},m=Object.values(c).reduce((e,a)=>({numberOfPatients:e.numberOfPatients+(parseInt(a.numberOfPatients)||0),nurseManager:e.nurseManager+(parseInt(a.nurseManager)||0),RN:e.RN+(parseInt(a.RN)||0),PN:e.PN+(parseInt(a.PN)||0),WC:e.WC+(parseInt(a.WC)||0),newAdmit:e.newAdmit+(parseInt(a.newAdmit)||0),transferIn:e.transferIn+(parseInt(a.transferIn)||0),referIn:e.referIn+(parseInt(a.referIn)||0),transferOut:e.transferOut+(parseInt(a.transferOut)||0),referOut:e.referOut+(parseInt(a.referOut)||0),discharge:e.discharge+(parseInt(a.discharge)||0),dead:e.dead+(parseInt(a.dead)||0),overallData:e.overallData+(parseInt(a.overallData)||0),availableBeds:e.availableBeds+(parseInt(a.availableBeds)||0),unavailable:e.unavailable+(parseInt(a.unavailable)||0),plannedDischarge:e.plannedDischarge+(parseInt(a.plannedDischarge)||0)}),{numberOfPatients:0,nurseManager:0,RN:0,PN:0,WC:0,newAdmit:0,transferIn:0,referIn:0,transferOut:0,referOut:0,discharge:0,dead:0,overallData:0,availableBeds:0,unavailable:0,plannedDischarge:0});return{...e,wards:c,totals:m}})},[]);(0,s.useCallback)(()=>{let e=new Date,a=new Date(y);return e.getDate()===a.getDate()&&e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()},[y]);let ea=()=>{if(!k.date)return!1;let e=new Date(k.date),a=new Date;return a.setDate(a.getDate()+1),e.setHours(0,0,0,0),a.setHours(0,0,0,0),e>a};(0,s.useCallback)(()=>Object.values(k.wards).some(e=>Object.entries(e).some(([e,a])=>"comment"!==e&&""!==a&&"0"!==a)),[k.wards]);let et=(0,s.useCallback)(()=>{let e={staff:!1,movement:!1,additional:!1};return Object.values(k.wards).forEach(a=>{("0"!==a.nurseManager||"0"!==a.RN||"0"!==a.PN||"0"!==a.WC)&&(e.staff=!0),("0"!==a.newAdmit||"0"!==a.transferIn||"0"!==a.referIn||"0"!==a.transferOut||"0"!==a.referOut||"0"!==a.discharge||"0"!==a.dead)&&(e.movement=!0),("0"!==a.availableBeds||"0"!==a.unavailable||"0"!==a.plannedDischarge||""!==a.comment.trim())&&(e.additional=!0)}),e},[k.wards]),er=(0,s.useCallback)(()=>{let e=et(k);return e.staff||e.movement||e.additional},[k]);(0,s.useEffect)(()=>{G(er())},[k,er]),(0,s.useEffect)(()=>{let e=e=>{F&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[F]),(0,s.useEffect)(()=>{let a=async()=>{if(F&&!(await c.A.fire({title:"แจ้งเตือนการออกจากหน้าบันทึกข้อมูล",html:`
                        <div class="text-left">
                            <p class="font-semibold">ท่านกำลังดำเนินการบันทึกข้อมูลอยู่</p>
                            <div class="mt-4 space-y-2">
                                <p class="text-gray-600">การออกจากหน้านี้จะส่งผลให้:</p>
                                <ul class="list-disc pl-5 text-sm text-gray-600">
                                    <li>ข้อมูลที่กำลังบันทึกจะถูกรีเซ็ตทั้งหมด</li>
                                    <li>ท่านจะต้องเริ่มกรอกข้อมูลใหม่เมื่อกลับมาที่หน้านี้</li>
                                </ul>
                            </div>
                            <p class="mt-4 text-sm font-medium text-gray-700">โปรดยืนยันการดำเนินการ</p>
                        </div>
                    `,icon:"warning",showCancelButton:!0,confirmButtonText:"ยืนยันการออกจากหน้านี้",cancelButtonText:"ยกเลิกและกลับไปบันทึกข้อมูล",confirmButtonColor:"#d33",cancelButtonColor:"#0ab4ab",reverseButtons:!0})).isConfirmed)throw"Route Cancelled"};return e.events?.on("routeChangeStart",a),()=>{e.events?.off("routeChangeStart",a)}},[F,e]);let es=(0,s.useCallback)(async()=>{console.log("Validating form data...",k);let e=new Date(new Date(k.date));e.setDate(e.getDate()-1);let a=e.toISOString().split("T")[0],t=await Q(a);if(!t.hasNightShift&&t.hasMorningShift)return await c.A.fire({title:"ไม่สามารถบันทึกข้อมูลได้",html:`วันที่ ${(0,b.mI)(e)} ยังไม่ได้บันทึกข้อมูลกะดึก<br>กรุณาบันทึกข้อมูลกะดึกของวันที่ ${(0,b.mI)(e)} ก่อน`,icon:"error",confirmButtonColor:"#0ab4ab"}),!1;for(let e of[{condition:!k.date||""===k.date.trim(),message:"กรุณาเลือกวันที่ก่อนดำเนินการต่อ"},{condition:!k.shift||""===k.shift.trim(),message:"กรุณาเลือกกะการทำงาน"},{condition:ea(),message:"ไม่สามารถบันทึกข้อมูลล่วงหน้าเกิน 1 วันได้"},{condition:"19:00-07:00"===k.shift&&!J,message:"ไม่สามารถบันทึกข้อมูลกะดึกได้ เนื่องจากยังไม่มีการบันทึกข้อมูลกะเช้าก่อน"},{condition:!S.supervisorFirstName?.trim()||!S.supervisorLastName?.trim(),message:"กรุณากรอกชื่อและนามสกุลผู้ตรวจการ"}])if(e.condition)return console.log("Validation failed:",e.message),e.message&&alert(e.message),!1;return!0},[k,S,ea,J]),en=()=>{c.A.fire({title:"ล้างข้อมูล?",text:"คุณต้องการล้างข้อมูลทั้งหมดใช่หรือไม่?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#0ab4ab",cancelButtonColor:"#d33",confirmButtonText:"ใช่, ล้างข้อมูล",cancelButtonText:"ยกเลิก"}).then(e=>{e.isConfirmed&&(T(e=>{let a={};return Object.entries(e.wards).forEach(([e,t])=>{a[e]={...t,nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",availableBeds:"0",unavailable:"0",plannedDischarge:"0",comment:""}}),{...e,wards:a}}),P({opdTotal24hr:"",existingPatients:"",newPatients:"",admissions24hr:"",supervisorFirstName:"",supervisorLastName:""}),G(!1),c.A.fire({title:"ล้างข้อมูลสำเร็จ",text:"กรุณาเลือกวันที่อีกครั้ง หรือตรวจสอบข้อมูลโดยรวมในหน้า Dashboard",icon:"success",confirmButtonColor:"#0ab4ab"}))})},el=async e=>{if(e.preventDefault(),await es()&&(await c.A.fire({title:"ยืนยันการบันทึกข้อมูล",text:"โปรดยืนยันว่าข้อมูลได้รับการตรวจสอบเรียบร้อยแล้ว",icon:"question",showCancelButton:!0,confirmButtonColor:"#0ab4ab",cancelButtonColor:"#d33",confirmButtonText:"บันทึกข้อมูล",cancelButtonText:"แก้ไขข้อมูล"})).isConfirmed)try{c.A.fire({title:"กำลังตรวจสอบข้อมูล",text:"กรุณารอสักครู่",allowOutsideClick:!1,didOpen:()=>{c.A.showLoading()}});let e=(0,l.rJ)(n.db,"staffRecords"),a=(0,l.P)(e,(0,l._M)("date","==",k.date),(0,l._M)("shift","==",k.shift)),t=await (0,l.GG)(a);if(!t.empty){let e=await c.A.fire({title:"พบข้อมูลซ้ำ",html:`พบข้อมูลของวันที่ ${(0,b.mI)(k.date)} กะ ${k.shift} ในระบบแล้ว<br><br>คุณต้องการดำเนินการอย่างไร?`,icon:"warning",showCancelButton:!0,showDenyButton:!0,confirmButtonText:"บันทึกทับ",denyButtonText:"ดูข้อมูลเดิม",cancelButtonText:"ยกเลิก",confirmButtonColor:"#0ab4ab",denyButtonColor:"#3085d6",cancelButtonColor:"#d33"});if(e.isDenied){let e=t.docs[0];M({id:e.id,...e.data()}),W(!0)}else e.isConfirmed&&(await ed(!0),window.location.reload());return}await ed(),G(!1)}catch(e){console.error("Error checking duplicates:",e),c.A.fire({title:"เกิดข้อผิดพลาด",text:e.message,icon:"error",confirmButtonColor:"#0ab4ab"})}},ei=async(e,a)=>{try{let t=(0,l.rJ)(n.db,"staffRecords"),r=(0,l.P)(t,(0,l._M)("date","==",e),(0,l._M)("shift","==",a));if(!(await (0,l.GG)(r)).empty)return await c.A.fire({title:"แจ้งเตือน",html:`มีข้อมูลของวันที่ ${(0,b.mI)(e)} กะ ${a} ในระบบแล้ว<br><br>หากต้องการแก้ไขข้อมูล กรุณาดำเนินการบันทึกข้อมูลใหม่`,icon:"info",confirmButtonColor:"#0ab4ab"}),!0;return!1}catch(e){return console.error("Error checking existing data:",e),!1}},ed=async(e=!1)=>{L(e=>({...e,savingData:!0})),$("กำลังบันทึกข้อมูล...");try{let a=new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit",hour12:!1}).replace(":",""),t=k.date.replace(/-/g,""),r=e&&R?R.id:`data_${a}_${t}`;console.log("Saving data with ID:",r);let s={date:k.date,shift:k.shift,wards:Object.fromEntries(Object.entries(k.wards).map(([e,a])=>[e,{numberOfPatients:a.numberOfPatients||"0",nurseManager:a.nurseManager||"0",RN:a.RN||"0",PN:a.PN||"0",WC:a.WC||"0",newAdmit:a.newAdmit||"0",transferIn:a.transferIn||"0",referIn:a.referIn||"0",transferOut:a.transferOut||"0",referOut:a.referOut||"0",discharge:a.discharge||"0",dead:a.dead||"0",overallData:a.overallData||"0",availableBeds:a.availableBeds||"0",plannedDischarge:a.plannedDischarge||"0",unavailable:a.unavailable||"0",comment:a.comment||""}])),summaryData:{opdTotal24hr:S.opdTotal24hr||"",existingPatients:S.existingPatients||"",newPatients:S.newPatients||"",admissions24hr:S.admissions24hr||"",supervisorFirstName:S.supervisorFirstName||"",supervisorLastName:S.supervisorLastName||""},timestamp:(0,l.O5)(),lastModified:(0,l.O5)()};console.log("Saving sanitized data:",s),await (0,l.BN)((0,l.H9)(n.db,"staffRecords",r),s);let i=Object.entries(k.wards).map(async([e,a])=>{if(Object.values(a).some(e=>"0"!==e&&""!==e)){let t=(0,l.H9)(n.db,"wardDailyRecords",`${k.date}_${e}`);try{await (0,l.BN)(t,{wardId:e,date:k.date,patientCensus:a.numberOfPatients||"0",overallData:a.overallData||"0",approvalStatus:"pending",lastUpdated:(0,l.O5)(),shifts:{[k.shift]:{nurseManager:a.nurseManager||"0",RN:a.RN||"0",PN:a.PN||"0",WC:a.WC||"0",newAdmit:a.newAdmit||"0",transferIn:a.transferIn||"0",referIn:a.referIn||"0",transferOut:a.transferOut||"0",referOut:a.referOut||"0",discharge:a.discharge||"0",dead:a.dead||"0",availableBeds:a.availableBeds||"0",unavailable:a.unavailable||"0",plannedDischarge:a.plannedDischarge||"0",comment:a.comment||""}}},{merge:!0})}catch(a){console.error(`Error saving wardDailyRecord for ${e}:`,a)}}});await Promise.all(i),await V(k.date),$("บันทึกข้อมูลสำเร็จ กำลังรีเซ็ตฟอร์ม..."),await new Promise(e=>setTimeout(e,1e3)),console.log("Data saved successfully"),en(),c.A.fire({title:"บันทึกข้อมูลสำเร็จ",text:"ข้อมูลถูกบันทึกเรียบร้อยแล้ว",icon:"success",confirmButtonColor:"#0ab4ab"}).then(()=>{window.location.reload()})}catch(e){console.error("Error saving data:",e),c.A.fire({title:"เกิดข้อผิดพลาด",text:e.message,icon:"error",confirmButtonColor:"#0ab4ab"})}finally{L(e=>({...e,savingData:!1,checkingDuplicates:!1})),$(""),W(!1)}},eo=async()=>{try{let e=(0,l.rJ)(n.db,"staffRecords"),a=new Date(new Date().getFullYear(),0,1),t=new Date(new Date().getFullYear(),11,31),r=(0,l.P)(e,(0,l._M)("date",">=",(0,b.Ol)(a)),(0,l._M)("date","<=",(0,b.Ol)(t))),s=await (0,l.GG)(r),i={};s.docs.forEach(e=>{let a=e.data();i[a.date]||(i[a.date]=new Set),i[a.date].add(a.shift)});let d=Object.entries(i).map(([e,a])=>({date:e,shifts:Array.from(a),isComplete:2===a.size}));O(d)}catch(e){console.error("Error fetching dates with data:",e),O([])}};(0,s.useEffect)(()=>{eo()},[]),(0,s.useEffect)(()=>()=>{m(!1),g(!1),j(!1)},[]);let ec=async(e,a)=>{try{$("กำลังดึงข้อมูลจากระบบ");let t=(0,l.rJ)(n.db,"wardDailyRecords"),r=new Date(e),s="";"19:00-07:00"===a?(s="07:00-19:00",$(`กำลังดึงข้อมูลจากกะเช้า-บ่าย (${s})`)):(r.setDate(r.getDate()-1),s="19:00-07:00",$(`กำลังดึงข้อมูลจากกะดึกของวันก่อนหน้า (${s})`));let i=(0,b.Ol)(r),d=(0,b.mI)(r).replace("เพิ่มข้อมูล วันที่: ","");$(`กำลังดึงข้อมูล Overall Data
จากวันที่ ${d}
กะ ${s}`);let o=(0,l.P)(t,(0,l._M)("date","==",i)),c=await (0,l.GG)(o),m={...k.wards};if(c.empty){$("กำลังค้นหาข้อมูลล่าสุด...");let e=(0,l.P)(t,(0,l._M)("date","<=",i),(0,l.My)("date","desc"),(0,l.AB)(1)),a=await (0,l.GG)(e);if(a.empty)$("ไม่พบข้อมูลก่อนหน้า"),setTimeout(()=>$(""),2e3);else{let e=a.docs[0].data(),t=(0,b.mI)(new Date(e.date)).replace("เพิ่มข้อมูล วันที่: ","");$(`พบข้อมูลล่าสุดจาก
วันที่ ${t}`),Object.keys(k.wards).forEach(e=>{let a=c.docs.find(a=>a.data().wardId===e)?.data();a&&(m[e]={...k.wards[e],numberOfPatients:a.overallData||"0",overallData:a.overallData||"0"})}),T(e=>({...e,wards:m})),setTimeout(()=>$(""),2e3)}}else c.docs.forEach(e=>{let a=e.data(),t=a.wardId;a.shifts&&a.shifts[s]&&(a.shifts[s],m[t]={...k.wards[t],numberOfPatients:a.overallData||"0",overallData:a.overallData||"0"})}),T(e=>({...e,wards:m})),$(`ดึงข้อมูลสำเร็จ
จากวันที่ ${d}
กะ ${s}`),setTimeout(()=>$(""),2e3)}catch(e){console.error("Error fetching previous shift data:",e),$(`เกิดข้อผิดพลาด: ${e.message}`),setTimeout(()=>$(""),3e3)}},em=(0,s.useCallback)(()=>{let e=Object.values(k.wards).some(e=>"0"!==e.nurseManager||"0"!==e.RN||"0"!==e.PN||"0"!==e.WC||"0"!==e.newAdmit||"0"!==e.transferIn||"0"!==e.referIn||"0"!==e.transferOut||"0"!==e.referOut||"0"!==e.discharge||"0"!==e.dead||"0"!==e.availableBeds||"0"!==e.unavailable||"0"!==e.plannedDischarge||""!==e.comment.trim()),a=""!==S.opdTotal24hr||""!==S.existingPatients||""!==S.newPatients||""!==S.admissions24hr||""!==S.supervisorFirstName||""!==S.supervisorLastName;return e||a},[k.wards,S]);(0,s.useEffect)(()=>{G(em())},[k,S,em]);let eu=async()=>{F?(await c.A.fire({title:"แจ้งเตือนการเปลี่ยนหน้า",html:`
                    <div class="text-left">
                        <p class="font-semibold text-red-600">ข้อควรระวัง: พบข้อมูลที่ยังไม่ได้บันทึก</p>
                        <div class="mt-4 space-y-2">
                            <p class="text-gray-700">การเปลี่ยนไปยังหน้า Dashboard จะส่งผลดังนี้:</p>
                            <ul className="list-disc pl-5 space-y-1">
                                <li class="text-gray-600">ข้อมูลที่ท่านกรอกจะไม่ถูกบันทึก</li>
                                <li class="text-gray-600">ข้อมูลทั้งหมดในแบบฟอร์มจะถูกรีเซ็ต</li>
                                <li class="text-gray-600">ท่านจะต้องเริ่มกรอกข้อมูลใหม่เมื่อกลับมายังหน้านี้</li>
                            </ul>
                            <div className="mt-4 p-2 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <p className="text-sm text-yellow-700">
                                    <span class="font-medium">คำแนะนำ:</span> กรุณาบันทึกข้อมูลให้เรียบร้อยก่อนออกจากหน้านี้
                                </p>
                                        </div>
                                        </div>
                                    </div>
                `,icon:"warning",showCancelButton:!0,confirmButtonText:"ยืนยันการเปลี่ยนหน้า",cancelButtonText:"ยกเลิกและกลับไปบันทึกข้อมูล",confirmButtonColor:"#d33",cancelButtonColor:"#0ab4ab",reverseButtons:!0})).isConfirmed&&e.push("/dashboard"):e.push("/dashboard")};return(0,r.jsxs)("div",{className:"w-full px-2 py-2",children:[_&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 bg-gradient-to-br from-[#0ab4ab]/95 to-blue-600/95 backdrop-blur-md flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl text-center space-y-4",children:[(0,r.jsx)("img",{src:"/images/BPK.jpg",alt:"BPK Logo",className:"w-24 h-24 mx-auto mb-4 animate-pulse"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-[#0ab4ab]",children:"แจ้งเตือนการใช้งาน"}),(0,r.jsxs)("div",{className:"space-y-3 text-gray-600",children:[(0,r.jsx)("p",{className:"font-medium",children:"ระบบอยู่ระหว่างการพัฒนาสำหรับอุปกรณ์มือถือ"}),(0,r.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-xl",children:[(0,r.jsx)("p",{className:"text-sm",children:"เพื่อประสิทธิภาพในการใช้งานสูงสุด กรุณาใช้งานผ่าน:"}),(0,r.jsxs)("ul",{className:"text-sm mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"• คอมพิวเตอร์ตั้งโต๊ะ (Desktop)"}),(0,r.jsx)("li",{children:"• คอมพิวเตอร์พกพา (Laptop)"})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"หากมีข้อสงสัยกรุณาติดต่อผู้ดูแลระบบ"})]})]})}),(0,r.jsxs)("form",{onSubmit:el,className:"w-full mx-auto",children:[i&&(0,r.jsx)("div",{className:"fixed inset-0 bg-white flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("img",{src:"/images/BPK.jpg",alt:"BPK Loading",className:"w-32 h-32 mx-auto mb-4 animate-pulse"}),(0,r.jsx)("p",{className:"text-gray-600",children:"กำลังโหลด..."})]})}),(0,r.jsx)(x,{showDataComparison:A,existingData:R,formData:k,summaryData:S,setShowDataComparison:W,saveData:ed,WARD_ORDER:d}),(0,r.jsx)(v,{showCalendar:N,setShowCalendar:j,selectedDate:y,setSelectedDate:D,formData:k,setFormData:T,thaiDate:B,setThaiDate:I,fetchPreviousShiftData:ec,handleShiftChange:e=>{T(a=>({...a,shift:e}))},datesWithData:C,checkExistingData:ei,setSummaryData:P}),(0,r.jsx)("div",{className:"hidden md:block w-full",children:(0,r.jsxs)("div",{className:"w-full mx-auto p-4 bg-white rounded-xl shadow-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-pink-400/20 to-white p-2 rounded-lg",children:(0,r.jsx)("h2",{className:"text-lg font-bold text-pink-600 text-center mb-1",children:"Form"})}),(0,r.jsx)(u,{WARD_ORDER:d,formData:k,handleInputChange:ee,displayValue:e=>null==e||""===e?"0":e,approvalStatuses:U,selectedDate:y})]})}),(0,r.jsx)("div",{className:"hidden md:block mt-8",children:(0,r.jsxs)("div",{className:"bg-gradient-to-r from-[#0ab4ab]/10 to-white rounded-xl shadow-lg p-6",children:[(0,r.jsx)(p,{summaryData:S,setSummaryData:P}),(0,r.jsx)(h,{summaryData:S,setSummaryData:P})]})}),(0,r.jsx)("div",{className:"mt-8 flex justify-center p-6 bg-gradient-to-r from-[#0ab4ab]/10 to-white rounded-xl shadow-lg",children:(0,r.jsx)("button",{type:"submit",disabled:f,className:"px-12 py-4 bg-gradient-to-r from-[#0ab4ab] to-blue-400 text-white text-lg font-bold rounded-xl shadow-lg hover:from-[#0ab4ab] hover:to-blue-500 transition-all transform hover:scale-105 disabled:from-gray-400 disabled:to-gray-500 font-THSarabun",children:f?"Saving...":"Save Data"})}),(0,r.jsx)("button",{onClick:eu,className:"px-4 py-2 rounded-lg text-white hover:bg-[#0ab4ab]/80",children:"Dashboard"})]})]})}},9863:()=>{}};