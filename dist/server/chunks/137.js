exports.id=137,exports.ids=[137],exports.modules={6932:(e,r,t)=>{Promise.resolve().then(t.bind(t,4206)),Promise.resolve().then(t.bind(t,2511))},9140:(e,r,t)=>{Promise.resolve().then(t.bind(t,1370)),Promise.resolve().then(t.bind(t,2701))},3744:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,3219,23)),Promise.resolve().then(t.t.bind(t,4863,23)),Promise.resolve().then(t.t.bind(t,5155,23)),Promise.resolve().then(t.t.bind(t,802,23)),Promise.resolve().then(t.t.bind(t,9350,23)),Promise.resolve().then(t.t.bind(t,8530,23)),Promise.resolve().then(t.t.bind(t,8921,23))},3472:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,6959,23)),Promise.resolve().then(t.t.bind(t,3875,23)),Promise.resolve().then(t.t.bind(t,8903,23)),Promise.resolve().then(t.t.bind(t,7174,23)),Promise.resolve().then(t.t.bind(t,4178,23)),Promise.resolve().then(t.t.bind(t,7190,23)),Promise.resolve().then(t.t.bind(t,1365,23))},1370:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(5512),o=t(9334),n=t(2780),a=t(2720),i=t(3673),l=t(8009);let c=()=>{let e=(0,o.useRouter)(),r=(0,o.usePathname)(),{user:t,logout:c}=(0,n.A)(),[d,u]=(0,l.useState)();(0,l.useEffect)(()=>{if("/"===r){u(window.currentPage||i.Nb.FORM);let e=()=>{u(window.currentPage)};return window.addEventListener("currentPageChange",e),()=>{window.removeEventListener("currentPageChange",e)}}"/ward-form"===r?u(i.Nb.WARD):"/approval"===r?u(i.Nb.FORM):"/dashboard"===r?u(i.Nb.DASHBOARD):r.includes("/admin/user-management")&&u(i.Nb.USER_MANAGEMENT)},[r]);let m=r=>{if(r===i.Nb.USER_MANAGEMENT&&t?.role?.toLowerCase()!=="admin"){a.A.fire({title:"ไม่มีสิทธิ์เข้าถึง",text:"คุณไม่มีสิทธิ์เข้าถึงหน้าจัดการผู้ใช้",icon:"warning",confirmButtonColor:"#0ab4ab"});return}switch(u(r),r){case i.Nb.WARD:e.push("/ward-form");break;case i.Nb.FORM:e.push("/approval");break;case i.Nb.DASHBOARD:e.push("/dashboard");break;case i.Nb.USER_MANAGEMENT:e.push("/admin/user-management");break;default:e.push("/")}},b=async()=>{try{(await a.A.fire({title:"ต้องการออกจากระบบ?",text:"คุณแน่ใจหรือไม่ว่าต้องการออกจากระบบ",icon:"question",showCancelButton:!0,confirmButtonText:"ใช่, ออกจากระบบ",cancelButtonText:"ยกเลิก",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed&&(await c(),e.push("/login"))}catch(e){console.error("Logout failed:",e),a.A.fire({title:"เกิดข้อผิดพลาด",text:"ไม่สามารถออกจากระบบได้ กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonColor:"#0ab4ab"})}};return t&&"/login"!==r?(0,s.jsx)("div",{className:"bg-[#0ab4ab] text-white shadow-md p-3 fixed top-0 left-0 right-0 z-50 w-full",children:(0,s.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>m(i.Nb.WARD),className:`px-3 py-1 rounded ${d===i.Nb.WARD?"bg-white text-[#0ab4ab]":"bg-[#0ab4ab] text-white hover:bg-teal-600"} transition font-medium`,children:i.gN[i.Nb.WARD]}),(0,s.jsx)("button",{onClick:()=>m(i.Nb.FORM),className:`px-3 py-1 rounded ${d===i.Nb.FORM?"bg-white text-[#0ab4ab]":"bg-[#0ab4ab] text-white hover:bg-teal-600"} transition font-medium`,children:i.gN[i.Nb.FORM]}),(0,s.jsx)("button",{onClick:()=>m(i.Nb.DASHBOARD),className:`px-3 py-1 rounded ${d===i.Nb.DASHBOARD?"bg-white text-[#0ab4ab]":"bg-[#0ab4ab] text-white hover:bg-teal-600"} transition font-medium`,children:i.gN[i.Nb.DASHBOARD]}),(0,s.jsx)("button",{onClick:()=>m(i.Nb.USER_MANAGEMENT),className:`px-3 py-1 rounded ${d===i.Nb.USER_MANAGEMENT?"bg-white text-[#0ab4ab]":"bg-[#0ab4ab] text-white hover:bg-teal-600"} transition font-medium`,children:i.gN[i.Nb.USER_MANAGEMENT]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"text-white text-sm mr-4",children:["Logged in as: ",t.username||"user"," | Department: ",t.department||""," | Role: ",t.role||"user"]}),(0,s.jsxs)("button",{onClick:b,className:"flex items-center px-3 py-1 bg-red-600 rounded-lg hover:bg-red-700 transition-all",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"ออกจากระบบ"]})]})]})}):null}},3673:(e,r,t)=>{"use strict";t.d(r,{Nb:()=>s,gN:()=>o});let s={WARD:"ward",FORM:"form",DASHBOARD:"dashboard",USER_MANAGEMENT:"user_management"},o={[s.WARD]:"Ward Form",[s.FORM]:"Approval",[s.DASHBOARD]:"Dashboard",[s.USER_MANAGEMENT]:"User Management"}},2780:(e,r,t)=>{"use strict";t.d(r,{O:()=>u,A:()=>d});var s=t(5512),o=t(8009);t(3104),t(7656);var n=t(8588);let a="app_logs",i=(e,r={})=>{try{let t={timestamp:new Date().toISOString(),event:e,properties:r},s=JSON.parse(localStorage.getItem(a)||"[]");s.push(t);let o=s.slice(-1e3);localStorage.setItem(a,JSON.stringify(o)),process.env.NEXT_PUBLIC_EXTERNAL_LOGGING_URL&&fetch(process.env.NEXT_PUBLIC_EXTERNAL_LOGGING_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).catch(console.error)}catch(e){console.warn("Logging failed:",e)}},l=(e,r={})=>{i(e,r)},c=(0,o.createContext)({}),d=()=>(0,o.useContext)(c);function u({children:e}){let[r,t]=(0,o.useState)(null),[a,i]=(0,o.useState)(!0),d=async(e,r)=>{try{let s=await (0,n.Lx)(e,r);if(s&&s.success){localStorage.setItem("user",JSON.stringify(s.user)),t(s.user);try{l("user_login",{userId:s.user.uid,timestamp:new Date().toISOString()})}catch(e){console.warn("Login logging failed:",e)}}return s}catch(e){return console.error("Login error:",e),{success:!1,error:e.message}}},u=null!==r;return(0,s.jsx)(c.Provider,{value:{user:r,loading:a,isAuthenticated:u,login:d,logout:()=>{try{let e=r?.uid;return localStorage.removeItem("user"),t(null),l("user_logout",{userId:e,timestamp:new Date().toISOString()}),!0}catch(e){return console.error("Logout error:",e),!1}}},children:e})}},2701:(e,r,t)=>{"use strict";t.r(r),t.d(r,{Providers:()=>a});var s=t(5512);t(8009);var o=t(2780);function n(){return(0,s.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,s.jsx)("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg shadow-lg px-4 py-2 border border-gray-200 hover:bg-white/90 transition-all duration-300",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"v.2.3.3.2025"})]})})})}function a({children:e}){return(0,s.jsxs)(o.O,{children:[e,(0,s.jsx)(n,{})]})}},8588:(e,r,t)=>{"use strict";t.d(r,{CF:()=>a,F7:()=>d,Lx:()=>n,TK:()=>l,hG:()=>c,nu:()=>i});var s=t(7656),o=t(3104);let n=async(e,r)=>{try{let t=(0,s.rJ)(o.db,"users"),n=(0,s.P)(t,(0,s._M)("username","==",e)),a=await (0,s.GG)(n);if(a.empty)return console.log("User not found in database:",e),{success:!1,error:"User not found"};let i=a.docs[0].data(),l=a.docs[0].id;if(console.log("Found user:",e,"Checking password..."),i.password!==r)return console.log("Invalid password for user:",e),{success:!1,error:"Invalid password"};return console.log("Login successful for user:",e),{success:!0,user:{uid:l,...i}}}catch(e){return console.error("Login error:",e.message),{success:!1,error:"Login failed: "+e.message}}},a=async()=>{try{let e=(0,s.rJ)(o.db,"users");return(await (0,s.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting users:",e.message),[]}},i=async e=>{try{let r={...e,createdAt:(0,s.O5)(),updatedAt:(0,s.O5)()},t=await (0,s.gS)((0,s.rJ)(o.db,"users"),r);return{success:!0,id:t.id}}catch(e){return console.error("Error adding user:",e.message),{success:!1,error:e.message}}},l=async(e,r)=>{try{let t={...r,updatedAt:(0,s.O5)()};return await (0,s.mZ)((0,s.H9)(o.db,"users",e),t),{success:!0}}catch(e){return console.error("Error updating user:",e.message),{success:!1,error:e.message}}},c=async e=>{try{return await (0,s.kd)((0,s.H9)(o.db,"users",e)),{success:!0}}catch(e){return console.error("Error deleting user:",e.message),{success:!1,error:e.message}}},d=async()=>{try{let e=(await a()).map(async e=>{let r={};if((!e.firstName||!e.lastName)&&e.fullName){let t=(e.fullName||"").split(" ");r.firstName=t[0]||"",r.lastName=t.slice(1).join(" ")||""}return(e.position||(e.role&&"admin"===e.role.toLowerCase()?r.position="ผู้ดูแลระบบ":r.position="เจ้าหน้าที่พยาบาล"),Object.keys(r).length>0)?(r.updatedAt=(0,s.O5)(),(0,s.mZ)((0,s.H9)(o.db,"users",e.id),r)):Promise.resolve()});return await Promise.all(e),{success:!0,message:"Updated all users successfully"}}catch(e){return console.error("Error updating users:",e.message),{success:!1,error:e.message}}}},3104:(e,r,t)=>{"use strict";t.d(r,{db:()=>i});var s=t(4341),o=t(7656),n=t(9324);let a=(0,s.Dk)().length?(0,s.Dk)()[0]:(0,s.Wp)({apiKey:"AIzaSyB9sZFJSn8cvkos5fysi47VpqJc5AsorA4",authDomain:"manpower-patient-summary.firebaseapp.com",projectId:"manpower-patient-summary",storageBucket:"manpower-patient-summary.firebasestorage.app",messagingSenderId:"644057496880",appId:"1:644057496880:web:6270efc29187b9c025dcf5"}),i=(0,o.aU)(a);(0,n.xI)(a)},4206:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\B_SIR\\\\OneDrive\\\\เดสก์ท็อป\\\\Summary_of_Personnel_Ratio\\\\Summary_of_Personnel_Ratio\\\\app\\\\components\\\\common\\\\Navbar.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\B_SIR\\OneDrive\\เดสก์ท็อป\\Summary_of_Personnel_Ratio\\Summary_of_Personnel_Ratio\\app\\components\\common\\Navbar.js","default")},2511:(e,r,t)=>{"use strict";t.r(r),t.d(r,{Providers:()=>s});let s=(0,t(6760).registerClientReference)(function(){throw Error("Attempted to call Providers() from the server but Providers is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\B_SIR\\OneDrive\\เดสก์ท็อป\\Summary_of_Personnel_Ratio\\Summary_of_Personnel_Ratio\\app\\context\\Providers.js","Providers")},4275:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n,metadata:()=>o});var s=t(2740);t(2704),t(2511),t(4206);let o={title:"Daily Patient Census and Staffing",description:"ระบบข้อมูลป่วยและตรากำคลากร"};function n({children:e}){return(0,s.jsxs)("html",{lang:"th",children:[(0,s.jsxs)("head",{children:[(0,s.jsx)("meta",{charSet:"utf-8"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,s.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap",rel:"stylesheet"})]}),(0,s.jsx)("body",{children:e})]})}},2704:()=>{}};