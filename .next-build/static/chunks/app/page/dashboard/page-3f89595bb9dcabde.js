(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[211],{119:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(5155),r=a(2115),l=a(4197),n=a(5112),i=a(6693),d=a(4065);let c=()=>(0,s.jsx)("div",{className:"animate-pulse w-full h-4 bg-gray-300 rounded-md"});a(8382);var o=a(4776),x=a(4279),h=a(4822);a(4875);var u=a(2808);i.t1.register(i.Bs,i.PP,i.kc,i.E8,i.hE,i.m_,i.s$);let m=()=>{var e;let{user:t}=(0,u.A)(),a=(null==t?void 0:null===(e=t.role)||void 0===e?void 0:e.toLowerCase())==="user",[i,m]=(0,r.useState)(!0),[g,b]=(0,r.useState)(null),[p,f]=(0,r.useState)([]),[w,v]=(0,r.useState)({startDate:new Date,shift:"all"}),[j,N]=(0,r.useState)(!1),[y,k]=(0,r.useState)(""),[C,O]=(0,r.useState)(null),[W,I]=(0,r.useState)(null),[D,P]=(0,r.useState)(!1),[A,S]=(0,r.useState)(new Date),[M,R]=(0,r.useState)((0,x.Lg)()),[_,B]=(0,r.useState)(!1),[E,G]=(0,r.useState)([]),[L,z]=(0,r.useState)(null),[T,F]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=new Date;S(e),R(Q(e))},[]);let Y=e=>{let t=new Date(e);return new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]},U=(0,r.useCallback)(async()=>{m(!0);try{let e;let s=(0,n.rJ)(l.db,"staffRecords"),r=Y(w.startDate),i=new Date(w.startDate.getFullYear(),0,1),d=new Date(w.startDate.getFullYear(),11,31);a&&(null==t?void 0:t.department)&&I(t.department),e=(0,n.P)(s,(0,n._M)("date",">=",Y(i)),(0,n._M)("date","<=",Y(d)));let c=await (0,n.GG)(e),o=new Map,x=null;c.docs.forEach(e=>{let t=e.data(),a=t.date,s=t.shift;o.has(a)||o.set(a,{shifts:new Set}),o.get(a).shifts.add(s),(!x||a>x)&&(x=a)});let h=Array.from(o.entries()).map(e=>{let[t,a]=e;return{date:t,isComplete:2===a.shifts.size,shifts:Array.from(a.shifts)}});G(h);let u=[];if("all"===w.shift){let e=(0,n.P)(s,(0,n._M)("date","==",r),(0,n._M)("shift","==","07:00-19:00")),t=(0,n.P)(s,(0,n._M)("date","==",r),(0,n._M)("shift","==","19:00-07:00")),[a,l]=await Promise.all([(0,n.GG)(e),(0,n.GG)(t)]);u=[...a.docs.map(e=>({id:e.id,...e.data()})),...l.docs.map(e=>({id:e.id,...e.data()}))]}else{let e=(0,n.P)(s,(0,n._M)("date","==",r),(0,n._M)("shift","==",w.shift));u=(await (0,n.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}if(console.log("Fetched Records:",u),console.log("Selected Date:",r),console.log("Current Filter:",w),u.length>0){f(u);let e=H(u);O(e)}else O(V());if(x){let e=new Date(x);R(Q(e))}}catch(e){console.error("Error fetching data:",e),b("ไม่สามารถโหลดข้อมูลได้"),O(V()),G([])}finally{m(!1)}},[w]);(0,r.useEffect)(()=>{U()},[U]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{F(!1)},1e3);return()=>clearTimeout(e)},[]);let q=async(e,s)=>{S(e),v(t=>({...t,startDate:e,shift:s||t.shift})),B(!1);try{let r;m(!0);let i=(0,n.rJ)(l.db,"staffRecords"),d=Y(e),c=new Date(e.getFullYear(),0,1),o=new Date(e.getFullYear(),11,31);a&&(null==t?void 0:t.department)&&I(t.department),r=(0,n.P)(i,(0,n._M)("date",">=",Y(c)),(0,n._M)("date","<=",Y(o)));let x=await (0,n.GG)(r),h=null;x.docs.forEach(e=>{let t=e.data().date;(!h||t>h)&&(h=t)});let u=[],g=s||w.shift;if("all"===g){let e=(0,n.P)(i,(0,n._M)("date","==",d),(0,n._M)("shift","==","07:00-19:00")),t=(0,n.P)(i,(0,n._M)("date","==",d),(0,n._M)("shift","==","19:00-07:00")),[a,s]=await Promise.all([(0,n.GG)(e),(0,n.GG)(t)]);u=[...a.docs.map(e=>({id:e.id,...e.data()})),...s.docs.map(e=>({id:e.id,...e.data()}))]}else{let e=(0,n.P)(i,(0,n._M)("date","==",d),(0,n._M)("shift","==",g));u=(await (0,n.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}if(u.length>0){a&&(null==t?void 0:t.department)&&u.forEach(e=>{if(e.wards){let a={};e.wards[t.department]&&(a[t.department]=e.wards[t.department]),e.wards=a}}),f(u);let e=H(u);O(e)}else O(V());if(h){let e=new Date(h);R(Q(e))}}catch(e){console.error("Error fetching data:",e),b("ไม่สามารถโหลดข้อมูลได้"),O(V())}finally{m(!1)}},V=()=>({totalRecords:0,totalPatients:0,totalStaff:0,totalAttendance:0,byWard:{},supervisorName:""}),H=e=>{if(!e||!Array.isArray(e)||0===e.length)return V();let t={},a={totalPatients:0,totalStaff:0,byWard:{},wards:{}};return e.forEach(e=>{e.wards&&Object.entries(e.wards).forEach(a=>{let[s,r]=a;if(t[s]||(t[s]={numberOfPatients:0,RN:0,PN:0,WC:0,NA:0,newAdmit:0,transferIn:0,referIn:0,transferOut:0,referOut:0,discharge:0,dead:0,overallData:0,availableBeds:0,unavailable:0}),"all"===w.shift||e.shift===w.shift){let e=parseInt(r.numberOfPatients)||0,a=parseInt(r.RN)||0,l=parseInt(r.PN)||0,n=parseInt(r.WC)||0,i=parseInt(r.NA)||0,d=parseInt(r.newAdmit)||0,c=parseInt(r.transferIn)||0,o=parseInt(r.referIn)||0,x=parseInt(r.transferOut)||0,h=parseInt(r.referOut)||0,u=parseInt(r.discharge)||0,m=parseInt(r.dead)||0,g=parseInt(r.availableBeds)||0,b=parseInt(r.unavailable)||0;t[s].numberOfPatients=e,t[s].RN=a,t[s].PN=l,t[s].WC=n,t[s].NA=i,t[s].newAdmit=d,t[s].transferIn=c,t[s].referIn=o,t[s].transferOut=x,t[s].referOut=h,t[s].discharge=u,t[s].dead=m,t[s].availableBeds=g,t[s].unavailable=b,t[s].overallData=e}})}),Object.entries(t).forEach(e=>{let[t,s]=e;a.totalPatients+=s.numberOfPatients,a.totalStaff+=s.RN+s.PN+s.WC+s.NA,a.byWard[t]=s.numberOfPatients,a.wards[t]=s}),{...a,totalRecords:e.length,totalAttendance:e.reduce((e,t)=>e+(parseInt(t.totalAttendance)||0),0),supervisorName:e.map(e=>e.supervisorName).filter(Boolean).join(", ")}};(0,r.useEffect)(()=>{a&&(null==t?void 0:t.department)?z({message:"คุณกำลังดูข้อมูลเฉพาะของแผนก ".concat(t.department," เท่านั้น"),type:"info"}):z(null)},[a,t]);let J={Ward6:"bg-pink-100 hover:bg-pink-200",Ward7:"bg-blue-100 hover:bg-blue-200",Ward8:"bg-violet-100 hover:bg-violet-200",Ward9:"bg-green-100 hover:bg-green-200",WardGI:"bg-yellow-100 hover:bg-yellow-200",Ward10B:"bg-sky-100 hover:bg-sky-200",Ward11:"bg-red-100 hover:bg-red-200",Ward12:"bg-cyan-100 hover:bg-cyan-200",ICU:"bg-indigo-100 hover:bg-indigo-200",CCU:"bg-orange-100 hover:bg-orange-200",LR:"bg-emerald-100 hover:bg-emerald-200",NSY:"bg-rose-100 hover:bg-rose-200"},$={background:["rgba(252, 231, 243, 0.8)","rgba(219, 234, 254, 0.8)","rgba(237, 233, 254, 0.8)","rgba(220, 252, 231, 0.8)","rgba(254, 249, 195, 0.8)","rgba(224, 242, 254, 0.8)","rgba(254, 226, 226, 0.8)","rgba(207, 250, 254, 0.8)","rgba(224, 231, 255, 0.8)","rgba(255, 237, 213, 0.8)","rgba(209, 250, 229, 0.8)","rgba(255, 228, 230, 0.8)"],border:["rgb(252, 231, 243)","rgb(219, 234, 254)","rgb(237, 233, 254)","rgb(220, 252, 231)","rgb(254, 249, 195)","rgb(224, 242, 254)","rgb(254, 226, 226)","rgb(207, 250, 254)","rgb(224, 231, 255)","rgb(255, 237, 213)","rgb(209, 250, 229)","rgb(255, 228, 230)"]},Z=["Ward6","Ward7","Ward8","Ward9","WardGI","Ward10B","Ward11","Ward12","ICU","CCU","LR","NSY"],K=(0,r.useMemo)(()=>{if(!(null==C?void 0:C.wards)||0===Object.keys(C.wards).length)return{pie:null,bar:null};let e=W?[W]:Z.filter(e=>C.wards[e]);if(0===e.length)return{pie:null,bar:null};let t=e.map(e=>{var t;return(null===(t=C.wards[e])||void 0===t?void 0:t.availableBeds)||0}),a=e.map(e=>{var t;return(null===(t=C.wards[e])||void 0===t?void 0:t.overallData)||0}),s=a.reduce((e,t)=>e+t,0);return{pie:{labels:e,datasets:[{data:t,backgroundColor:W?[$.background[Z.indexOf(W)]]:$.background.slice(0,e.length),borderColor:W?[$.border[Z.indexOf(W)]]:$.border.slice(0,e.length),borderWidth:1}]},bar:{labels:W?[W]:[...e,"Total"],datasets:[{label:"Overall Data",data:W?a:[...a,s],backgroundColor:W?[$.background[Z.indexOf(W)]]:[...$.background.slice(0,e.length),"rgba(75, 192, 192, 0.8)"],borderColor:W?[$.border[Z.indexOf(W)]]:[...$.border.slice(0,e.length),"rgb(75, 192, 192)"],borderWidth:1}]}}},[C,Z,W]),Q=e=>{let t=e.getDate(),a=["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"][e.getMonth()],s=e.getFullYear()+543;return"".concat(t," ").concat(a," ").concat(s)};return i?(0,s.jsx)(c,{}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[T&&(0,s.jsx)(o.A,{}),(0,s.jsxs)("div",{className:"max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6 bg-white rounded-xl shadow-sm p-6",children:[(0,s.jsx)("div",{className:"w-full md:w-3/4",children:(0,s.jsx)(h.A,{selectedDate:A,onDateSelect:q,datesWithData:E,showCalendar:_,setShowCalendar:B,thaiDate:M,variant:"dashboard"})}),(0,s.jsx)("div",{className:"w-full md:w-1/4 flex justify-center md:justify-end",children:(0,s.jsx)("div",{className:"inline-flex rounded-md shadow-sm",children:["all","07:00-19:00","19:00-07:00"].map((e,t)=>(0,s.jsx)("button",{onClick:()=>v(t=>({...t,shift:e})),className:"\n                                                px-4 py-2 text-sm font-medium\n                                                ".concat(0===t?"rounded-l-md":2===t?"rounded-r-md":"","\n                                                ").concat(w.shift===e?"bg-blue-500 text-white border-blue-600 z-10":"bg-white text-gray-700 border-gray-200 hover:bg-blue-50","\n                                                border ").concat(0!==t?"border-l-0":"","\n                                                transition-all duration-200\n                                            "),children:"all"===e?"ทั้งหมด":"07:00-19:00"===e?"กะเช้า":"กะดึก"},e))})})]})})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6 mb-10",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 shadow-lg cursor-pointer hover:shadow-xl transition-all duration-200 h-full flex flex-col justify-center",onClick:()=>{var e;I(null),null===(e=document.getElementById("detailed-ward-info"))||void 0===e||e.scrollIntoView({behavior:"smooth"})},children:(0,s.jsxs)("div",{className:"text-center py-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-white mb-3",children:"Patient Census"}),(0,s.jsx)("p",{className:"text-6xl font-bold text-white",children:(null==C?void 0:C.totalPatients)||0})]})})}),(0,s.jsx)("div",{className:"lg:col-span-4",children:(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:Object.entries((null==C?void 0:C.byWard)||{}).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{onClick:()=>{var e;I(t),null===(e=document.getElementById("detailed-ward-info"))||void 0===e||e.scrollIntoView({behavior:"smooth"})},className:"\n                                        ".concat(J[t]," p-4 rounded-xl shadow-sm \n                                        cursor-pointer transform transition-all duration-200 \n                                        hover:scale-105 hover:shadow-md\n                                        ").concat(W===t?"ring-2 ring-blue-500":"","\n                                    "),children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-800 text-center mb-2",children:t}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 text-center",children:a})]},t)})})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow duration-200",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-6 flex justify-between items-center",children:[(0,s.jsx)("span",{children:"Available Beds Distribution"}),W&&(0,s.jsxs)("button",{onClick:()=>I(null),className:"text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Show All"]})]}),(0,s.jsxs)("div",{className:"h-[450px]",children:[" ",(null==K?void 0:K.pie)&&K.pie.labels&&K.pie.labels.length>0?(0,s.jsx)(d.Fq,{data:K.pie,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},title:{display:!0,text:"Available Beds by Ward",color:"black",font:{size:16}},tooltip:{callbacks:{label:e=>{let t=e.label||"",a=e.raw||0;return"".concat(t,": ").concat(a," beds available")}}}},onClick:(e,t)=>{t&&t.length>0&&I(K.pie.labels[t[0].index])},elements:{arc:{cursor:"pointer"}}}}):(0,s.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500",children:"No data available"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow duration-200",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-6 flex justify-between items-center",children:[(0,s.jsx)("span",{children:"Overall Data by Ward"}),W&&(0,s.jsxs)("button",{onClick:()=>I(null),className:"text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Show All"]})]}),(0,s.jsxs)("div",{className:"h-[450px]",children:[" ",(null==K?void 0:K.bar)&&K.bar.labels&&K.bar.labels.length>0?(0,s.jsx)(d.yP,{data:K.bar,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Overall Data by Ward",color:"black",font:{size:16}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Number of Patients"}}},onClick:(e,t)=>{if(t&&t.length>0){let e=K.bar.labels[t[0].index];"Total"===e?I(null):I(e)}},elements:{bar:{cursor:"pointer"}}}}):(0,s.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500",children:"No data available"})]})]})]}),(0,s.jsxs)("div",{id:"detailed-ward-info",className:"bg-white rounded-xl shadow-sm p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-6 text-center",children:W?"".concat(W," Information"):"Detailed Ward Information"}),(0,s.jsxs)("div",{className:"hidden md:block",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsx)("div",{className:"inline-block min-w-full",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gradient-to-r from-blue-50 to-blue-100",children:[(0,s.jsx)("th",{className:"sticky left-0 bg-gradient-to-r from-blue-50 to-blue-100 p-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Ward"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Census"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"RN"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"PN"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"WC"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"New"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"T-In"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"R-In"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"T-Out"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"R-Out"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"D/C"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Dead"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider bg-blue-100",children:"Total"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Avail"}),(0,s.jsx)("th",{className:"p-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Unavail"})]})}),(0,s.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[Object.entries((null==C?void 0:C.byWard)||{}).filter(e=>{let[t]=e;return!W||t===W}).map((e,t)=>{var a;let[r,l]=e,n=(null==C?void 0:null===(a=C.wards)||void 0===a?void 0:a[r])||{};return(0,s.jsxs)("tr",{className:"".concat(t%2==0?"bg-white":"bg-gray-50"," hover:bg-blue-50"),children:[(0,s.jsx)("td",{className:"sticky left-0 p-3 text-xs font-medium text-gray-900 text-center whitespace-nowrap bg-inherit",children:r}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.numberOfPatients||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.RN||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.PN||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.WC||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.newAdmit||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.transferIn||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.referIn||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.transferOut||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.referOut||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.discharge||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.dead||0}),(0,s.jsx)("td",{className:"p-3 text-xs font-medium text-gray-900 text-center whitespace-nowrap bg-blue-50",children:n.overallData||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.availableBeds||0}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:n.unavailable||0})]},r)}),(0,s.jsxs)("tr",{className:"bg-blue-100 font-semibold",children:[(0,s.jsx)("td",{className:"sticky left-0 p-3 text-xs font-medium text-gray-900 text-center whitespace-nowrap bg-blue-100",children:"Total"}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.numberOfPatients||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.RN||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.PN||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.WC||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.newAdmit||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.transferIn||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.referIn||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.transferOut||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.referOut||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.discharge||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.dead||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs font-medium text-gray-900 text-center whitespace-nowrap bg-blue-200",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.overallData||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.availableBeds||0),0)}),(0,s.jsx)("td",{className:"p-3 text-xs text-gray-800 text-center whitespace-nowrap",children:Object.values((null==C?void 0:C.wards)||{}).reduce((e,t)=>e+(t.unavailable||0),0)})]})]})]})})}),(0,s.jsx)("div",{className:"mt-4 text-center text-sm text-gray-500",children:"← Scroll horizontally to view more →"})]}),(0,s.jsx)("div",{className:"md:hidden space-y-4",children:Object.entries((null==C?void 0:C.byWard)||{}).filter(e=>{let[t]=e;return!W||t===W}).map(e=>{var t;let[a]=e,r=(null==C?void 0:null===(t=C.wards)||void 0===t?void 0:t[a])||{};return(0,s.jsxs)("div",{className:"\n                                            ".concat(J[a]," rounded-xl p-5 shadow-sm\n                                            hover:shadow-md transition-all duration-200\n                                        "),children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:a}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white bg-opacity-60 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Census"}),(0,s.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:r.numberOfPatients||0})]}),(0,s.jsxs)("div",{className:"bg-white bg-opacity-60 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total"}),(0,s.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:r.overallData||0})]}),(0,s.jsxs)("div",{className:"bg-white bg-opacity-60 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Available"}),(0,s.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:r.availableBeds||0})]}),(0,s.jsxs)("div",{className:"bg-white bg-opacity-60 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Staff"}),(0,s.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:(r.RN||0)+(r.PN||0)+(r.WC||0)})]})]})]},a)})})]}),W&&(0,s.jsx)("div",{className:"flex justify-center mt-8",children:(0,s.jsx)("button",{onClick:()=>I(null),className:"   px-6 py-3 bg-blue-500 text-white rounded-lg   hover:bg-blue-600 focus:outline-none focus:ring-2    focus:ring-offset-2 focus:ring-blue-500   shadow-sm hover:shadow-md transition-all duration-200   font-medium   ",children:"แสดง Ward"})}),L&&(0,s.jsx)(e=>{let{message:t,type:a,onClose:r}=e;return(0,s.jsx)("div",{className:"\n                fixed top-4 right-4 z-[60] p-4 rounded-lg shadow-lg\n                ".concat("warning"===a?"bg-yellow-50 text-yellow-800":"bg-blue-50 text-blue-800","\n                transition-all duration-300 ease-in-out\n            "),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["warning"===a?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"font-medium",children:t}),(0,s.jsx)("button",{onClick:r,className:"ml-2 hover:text-gray-600",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})})},{...L,onClose:()=>z(null)})]})]})};var g=a(9092);function b(){return(0,s.jsx)(g.A,{title:"Dashboard",children:(0,s.jsx)(m,{})})}},4613:(e,t,a)=>{"use strict";a.d(t,{h:()=>s});let s="v.2.3.3.2025"},4779:(e,t,a)=>{Promise.resolve().then(a.bind(a,119))},4875:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(5155);a(2115);let r=e=>{let{selectedShift:t,onShiftChange:a,variant:r="form",theme:l="light"}=e,n=e=>{"function"==typeof a?a(e):console.warn("onShiftChange is not a function in ShiftSelection")};return(0,s.jsx)("div",{className:"".concat("dark"===l?"bg-gray-800/60 shadow-gray-900 border border-gray-700":"bg-white/60 shadow-gray-200"," backdrop-blur-sm rounded-xl p-3 shadow-sm hover:shadow-md transition-all"),children:(0,s.jsx)("div",{className:"flex flex-col md:flex-row justify-center gap-4",children:("dashboard"===r?[{id:"all",label:"ทั้งวัน",value:"all"},{id:"morning",label:"กะเช้า",value:"07:00-19:00"},{id:"night",label:"กะดึก",value:"19:00-07:00"}]:[{id:"morning",label:"กะเช้า",value:"07:00-19:00"},{id:"night",label:"กะดึก",value:"19:00-07:00"}]).map(e=>{let{id:a,label:r,value:i}=e;return(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsxs)("label",{className:"relative flex items-center gap-2 cursor-pointer group",children:[(0,s.jsx)("input",{type:"radio",name:"shift",value:i,checked:t===i,onChange:()=>n(i),className:"hidden"}),(0,s.jsx)("div",{className:"w-5 h-5 rounded-full border-2 transition-all ".concat(t===i?"border-[#0ab4ab] bg-[#0ab4ab]":"dark"===l?"border-gray-500 group-hover:border-[#0ab4ab]/70":"border-gray-300 group-hover:border-[#0ab4ab]/50"),children:t===i&&(0,s.jsx)("div",{className:"w-2 h-2 bg-white rounded-full m-auto mt-0.5"})}),(0,s.jsxs)("span",{className:"text-sm transition-colors ".concat(t===i?"text-[#0ab4ab] font-medium":"dark"===l?"text-gray-200":"text-gray-600"),children:[r,(0,s.jsxs)("span",{className:"dark"===l?"text-gray-400":"text-gray-500",children:["(",i,")"]})]})]})},a)})})})}},9092:(e,t,a)=>{"use strict";a.d(t,{A:()=>x});var s=a(5155),r=a(2115),l=a(5695),n=a(2808),i=a(7775),d=a(4776),c=a(4613),o=a(9770);function x(e){let{children:t,title:a,requiredRole:x="user",infoBox:h}=e,{user:u,loading:m,isAuthenticated:g}=(0,n.A)(),b=(0,l.useRouter)(),[p,f]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{m||g||b.push("/login"),u&&u.role&&("admin"===u.role.toLowerCase()?f(!0):"user"===x?f(!0):u.role.toLowerCase()===x.toLowerCase()?f(!0):(f(!1),(0,o.$s)("unauthorized_access_attempt",{userRole:u.role,requiredRole:x,page:a})))},[m,g,b,u,x,a]),m)?(0,s.jsx)(d.A,{}):g?p?(0,s.jsx)(i.A,{requiredRole:x,children:(0,s.jsxs)("div",{className:"min-h-screen pb-16 relative",children:[(0,s.jsxs)("main",{className:"container mx-auto px-4 pt-20",children:[a&&(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-6",children:a}),h&&(0,s.jsx)("div",{className:"mb-6",children:h}),t]}),(0,s.jsx)("div",{className:"fixed bottom-4 right-4 text-sm text-gray-500",children:c.h})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsx)("div",{className:"max-w-md w-full p-6 bg-white rounded-lg shadow-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("svg",{className:"mx-auto h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,s.jsx)("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"ไม่มีสิทธิ์เข้าถึง"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"คุณไม่มีสิทธิ์เพียงพอในการเข้าถึงหน้านี้ กรุณาติดต่อผู้ดูแลระบบหากคุณเชื่อว่านี่เป็นข้อผิดพลาด"}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>b.push("/"),children:"กลับไปยังหน้าหลัก"})})]})})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[445,766,902,65,808,688,315,358],()=>t(4779)),_N_E=e.O()}]);