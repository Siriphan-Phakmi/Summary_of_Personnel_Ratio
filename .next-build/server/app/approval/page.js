(()=>{var e={};e.id=12,e.ids=[12],e.modules={1191:(e,t,r)=>{"use strict";r.d(t,{N6:()=>i,UX:()=>s,XU:()=>a});let a={Ward6:"Ward 6",Ward7:"Ward 7",Ward8:"Ward 8",Ward9:"Ward 9",WardGI:"Ward GI",Ward10B:"Ward 10B",Ward11:"Ward 11",Ward12:"Ward 12",ICU:"ICU",CCU:"CCU",LR:"LR",NSY:"NSY"},s=["Ward6","Ward7","Ward8","Ward9","WardGI","Ward10B","Ward11","Ward12","ICU","CCU","LR","NSY"],i={numberOfPatients:"0",nurseManager:"0",RN:"0",PN:"0",WC:"0",newAdmit:"0",transferIn:"0",referIn:"0",transferOut:"0",referOut:"0",discharge:"0",dead:"0",overallData:"0",availableBeds:"0",plannedDischarge:"0",unavailable:"0",comment:""}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14985:e=>{"use strict";e.exports=require("dns")},16509:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(60687),s=r(43210),i=r(16189),n=r(84623);function d({children:e,requiredRole:t=null}){let{user:r,loading:d,isAuthenticated:l}=(0,n.A)();(0,i.useRouter)();let[o,c]=(0,s.useState)(!1),[p,u]=(0,s.useState)(!0),[m,x]=(0,s.useState)(!1);return(0,a.jsx)("div",{className:"min-h-screen"})}r(36006)},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},22159:(e,t,r)=>{Promise.resolve().then(r.bind(r,81543))},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},28764:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(60687),s=r(43210),i=r(16189),n=r(9141),d=r(75535),l=r(39245),o=r(84623),c=r(1923),p=r(36006),u=r(1191);let m=()=>{let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(!0),[m,x]=(0,s.useState)("all"),{user:h}=(0,o.A)();(0,s.useEffect)(()=>{(async()=>{i(!0);try{let e=(0,d.rJ)(n.db,"wardDailyRecords"),r=(0,d.P)(e,(0,d._M)("approvalStatus","==","pending"),(0,d.My)("lastUpdated","desc"),(0,d.AB)(50)),a=await (0,d.GG)(r),s=[];a.forEach(e=>{let t=e.data();s.push({id:e.id,...t,formType:"ward",dateSubmitted:t.dateSubmitted?.toDate()||new Date,lastUpdated:t.lastUpdated?.toDate()||new Date})}),t(s)}catch(e){console.error("Error fetching pending approvals:",e),c.YU.fire({title:"เกิดข้อผิดพลาด",text:"ไม่สามารถดึงข้อมูลรายการที่รออนุมัติได้",icon:"error"})}finally{i(!1)}})()},[m]);let f=async e=>{try{let t=e.wardId,r=e.date;if(!(await c.YU.fire({title:"ยืนยันการอนุมัติ",html:`คุณต้องการอนุมัติข้อมูล Ward ใช่หรือไม่?<br>
               วันที่: ${(0,l.mI)(r)}<br>
               วอร์ด: ${u.XU[t]||t}`,icon:"question",showCancelButton:!0,confirmButtonText:"อนุมัติ",cancelButtonText:"ยกเลิก",confirmButtonColor:"#0ab4ab"})).isConfirmed)return;let a=(0,d.H9)(n.db,"wardDailyRecords",e.id);await (0,d.mZ)(a,{approvalStatus:"approved",approvedBy:{uid:h.uid,displayName:h.displayName||"",email:h.email||""},approvedAt:new Date}),c.YU.fire({title:"อนุมัติสำเร็จ",text:`ข้อมูล Ward ${u.XU[t]||t} ได้รับการอนุมัติแล้ว`,icon:"success",confirmButtonColor:"#0ab4ab"}),fetchPendingApprovals()}catch(e){console.error("Error approving item:",e),c.YU.fire({title:"เกิดข้อผิดพลาด",text:"ไม่สามารถอนุมัติข้อมูลได้ กรุณาลองอีกครั้ง",icon:"error",confirmButtonColor:"#0ab4ab"})}},b=async e=>{try{let t=e.wardId,r=e.date,a=await c.YU.fire({title:"ปฏิเสธข้อมูล",html:`
          <div class="text-left">
            <p class="mb-2">กรุณาระบุเหตุผลในการปฏิเสธข้อมูลของ ${u.XU[t]||t}</p>
            <p class="text-sm text-gray-600">วันที่: ${(0,l.mI)(r)}</p>
            <textarea id="rejection-reason" class="w-full mt-3 px-3 py-2 border border-gray-300 rounded" rows="3" placeholder="ระบุเหตุผล..."></textarea>
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonText:"ปฏิเสธ",cancelButtonText:"ยกเลิก",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",preConfirm:()=>{let e=document.getElementById("rejection-reason").value;return e.trim()||c.YU.showValidationMessage("กรุณาระบุเหตุผลในการปฏิเสธ"),e}});if(!a.isConfirmed)return;let s=a.value,i=(0,d.H9)(n.db,"wardDailyRecords",e.id);await (0,d.mZ)(i,{approvalStatus:"rejected",rejectedBy:{uid:h.uid,displayName:h.displayName||"",email:h.email||""},rejectedAt:new Date,rejectionReason:s}),c.YU.fire({title:"ปฏิเสธข้อมูลสำเร็จ",text:`ข้อมูล Ward ${u.XU[t]||t} ถูกปฏิเสธเรียบร้อยแล้ว`,icon:"success",confirmButtonColor:"#0ab4ab"}),fetchPendingApprovals()}catch(e){console.error("Error rejecting item:",e),c.YU.fire({title:"เกิดข้อผิดพลาด",text:"ไม่สามารถปฏิเสธข้อมูลได้ กรุณาลองอีกครั้ง",icon:"error",confirmButtonColor:"#0ab4ab"})}},g=async e=>{let t=e.wardId,r=e.date,a=`
      <div class="text-left">
        <p class="font-medium mb-2">ข้อมูล Ward: ${u.XU[t]||t}</p>
        <p class="text-sm">วันที่: ${(0,l.mI)(r)}</p>
        
        <div class="mt-4">
          <p class="font-medium">ข้อมูลกะ:</p>
          <ul class="text-sm mt-1 space-y-1">
    `;e.shifts&&Object.entries(e.shifts).forEach(([e,t])=>{a+=`<li class="pl-2 border-l-2 border-gray-300">${e}</li>`}),a+=`
          </ul>
        </div>
        
        <div class="mt-4">
          <p class="font-medium">ผู้บันทึกข้อมูล:</p>
          <p class="text-sm">${e.submittedBy?.displayName||"-"}</p>
        </div>
        
        <div class="mt-4">
          <p class="font-medium">เวลาบันทึก:</p>
          <p class="text-sm">${e.dateSubmitted?new Date(e.dateSubmitted).toLocaleString("th-TH"):"-"}</p>
        </div>
      </div>
    `,await c.YU.fire({title:"รายละเอียดข้อมูล",html:a,confirmButtonText:"ปิด",confirmButtonColor:"#0ab4ab"})};return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"รายการรออนุมัติ"}),r?(0,a.jsx)(p.A,{}):0===e.length?(0,a.jsx)("div",{className:"bg-gray-50 p-8 rounded-lg text-center",children:(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"ไม่มีรายการที่รออนุมัติ"})}):(0,a.jsx)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วอร์ด"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันที่"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"กะ"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ผู้บันทึก"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันที่บันทึก"}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"font-medium text-gray-900",children:u.XU[e.wardId]||e.wardId})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.mI)(e.date)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.shifts?Object.keys(e.shifts).join(", "):"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.submittedBy?.displayName||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.dateSubmitted?new Date(e.dateSubmitted).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>g(e),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"ดูข้อมูล"}),(0,a.jsx)("button",{onClick:()=>f(e),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"อนุมัติ"}),(0,a.jsx)("button",{onClick:()=>b(e),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:"ปฏิเสธ"})]})})]},e.id))})]})})]})};var x=r(16509);function h(){let{user:e,loading:t,isAuthenticated:r}=(0,o.A)();return((0,i.useRouter)(),t)?(0,a.jsx)(p.A,{}):r?(0,a.jsx)(x.A,{requiredRole:"supervisor",children:(0,a.jsxs)("div",{className:"min-h-screen pb-16 relative",children:[(0,a.jsxs)("main",{className:"container mx-auto px-4 pt-20",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 mb-6 rounded-lg border border-blue-200",children:[(0,a.jsx)("h2",{className:"font-medium text-blue-700 mb-2",children:"หน้าอนุมัติข้อมูล"}),(0,a.jsx)("p",{className:"text-sm text-blue-600",children:"คุณสามารถตรวจสอบและอนุมัติข้อมูลที่ถูกส่งจากผู้ใช้งานได้ที่นี่ โดยแบ่งตามประเภทข้อมูล Ward และ Shift"})]}),(0,a.jsx)(m,{})]}),(0,a.jsx)("div",{className:"fixed bottom-4 right-4 text-sm text-gray-500",children:"v.2.3.3.2025"})]})}):null}},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},36006:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(60687),s=r(43210),i=r(30474);let n=({timeout:e=15e3,onTimeout:t,showRetry:r=!1})=>{let[n,d]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let r=setTimeout(()=>{d(!0),t&&t()},e);return()=>clearTimeout(r)},[e,t]),(0,a.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-white via-blue-50 to-[#0ab4ab]/10 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white/80 p-8 rounded-2xl shadow-xl backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"relative w-32 h-32 mx-auto mb-4",children:(0,a.jsx)(i.default,{src:"/images/BPK.jpg",alt:"BPK Loading",fill:!0,style:{objectFit:"contain"},className:`rounded-lg ${n?"":"animate-pulse"}`,priority:!0})}),(0,a.jsx)("div",{className:"flex flex-col items-center",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-red-600 font-medium mb-2",children:"การโหลดข้อมูลใช้เวลานานเกินไป"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"กรุณาตรวจสอบการเชื่อมต่อและลองใหม่อีกครั้ง"}),r&&(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-[#0ab4ab] text-white rounded-lg hover:bg-[#098f88] transition-colors",children:"ลองใหม่"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#0ab4ab] mb-3"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"กำลังโหลดข้อมูล..."}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"โปรดรอสักครู่"})]})})]})})})}},39245:(e,t,r)=>{"use strict";r.d(t,{Lg:()=>s,Ol:()=>i,RB:()=>l,S2:()=>d,bU:()=>n,mI:()=>a});let a=e=>{if(!e)return"คุณยังไม่ได้เลือกวันที่";let t=new Date(e),r=t.getDate(),a=["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"][t.getMonth()],s=t.getFullYear()+543;return`${r} ${a} ${s}`},s=()=>a(new Date),i=e=>{let t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},n=e=>{let t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${s}`},d=()=>["January","February","March","April","May","June","July","August","September","October","November","December"],l=e=>{let t=[];for(let e=2e3;e<=4e3;e++)t.push(e);return t}},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81543:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\B_SIR\\\\OneDrive\\\\เดสก์ท็อป\\\\Active 14-3-2025\\\\Summary_of_Personnel_Ratio\\\\app\\\\approval\\\\page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\B_SIR\\OneDrive\\เดสก์ท็อป\\Active 14-3-2025\\Summary_of_Personnel_Ratio\\app\\approval\\page.js","default")},81630:e=>{"use strict";e.exports=require("http")},81991:(e,t,r)=>{Promise.resolve().then(r.bind(r,28764))},86961:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>o});var a=r(65239),s=r(48088),i=r(88170),n=r.n(i),d=r(30893),l={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);r.d(t,l);let o={children:["",{children:["approval",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,81543)),"C:\\Users\\B_SIR\\OneDrive\\เดสก์ท็อป\\Active 14-3-2025\\Summary_of_Personnel_Ratio\\app\\approval\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,32648)),"C:\\Users\\B_SIR\\OneDrive\\เดสก์ท็อป\\Active 14-3-2025\\Summary_of_Personnel_Ratio\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\B_SIR\\OneDrive\\เดสก์ท็อป\\Active 14-3-2025\\Summary_of_Personnel_Ratio\\app\\approval\\page.js"],p={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/approval/page",pathname:"/approval",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[719,684,474,556],()=>r(86961));module.exports=a})();